{"version":3,"file":"Cron.js","sourceRoot":"./src/","sources":["Dialogs/Cron.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { type JSX } from 'react';\n\nimport { Button, DialogTitle, DialogContent, DialogActions, Dialog, Radio } from '@mui/material';\n\nimport { Check as IconOk, Cancel as IconCancel } from '@mui/icons-material';\n\nimport { ComplexCron } from '../Components/ComplexCron';\nimport { SimpleCron, cron2state } from '../Components/SimpleCron';\nimport { Schedule } from '../Components/Schedule';\n\nimport { I18n } from '../i18n';\nimport type { IobTheme } from '../types';\n\n// Generate cron expression\n\nconst styles: Record<string, React.CSSProperties> = {\n    dialogPaper: {\n        height: 'calc(100% - 96px)',\n    },\n};\n\ninterface DialogCronProps {\n    onClose: () => void;\n    onOk: (cron: string) => void;\n    title?: string;\n    cron?: string;\n    cancel?: string;\n    ok?: string;\n    /** show only simple configuration */\n    simple?: boolean;\n    /** show only complex configuration */\n    complex?: boolean;\n    /** do not show wizard */\n    noWizard?: boolean;\n    theme: IobTheme;\n}\n\ninterface DialogCronState {\n    cron: string;\n    mode: 'simple' | 'complex' | 'wizard';\n}\n\nexport class DialogCron extends React.Component<DialogCronProps, DialogCronState> {\n    constructor(props: DialogCronProps) {\n        super(props);\n        let cron;\n        if (this.props.cron && typeof this.props.cron === 'string' && this.props.cron.replace(/^[\"']/, '')[0] !== '{') {\n            cron = this.props.cron.replace(/['\"]/g, '').trim();\n        } else {\n            cron = this.props.cron || '{}';\n            if (typeof cron === 'string') {\n                cron = cron.replace(/^[\"']/, '').replace(/[\"']\\n?$/, '');\n            }\n        }\n\n        this.state = {\n            cron,\n            mode: this.props.simple\n                ? 'simple'\n                : this.props.complex\n                  ? 'complex'\n                  : (typeof cron === 'object' || cron[0] === '{') && !this.props.noWizard\n                    ? 'wizard'\n                    : cron2state(this.props.cron || '* * * * *')\n                      ? 'simple'\n                      : 'complex',\n        };\n    }\n\n    handleCancel(): void {\n        this.props.onClose();\n    }\n\n    handleOk(): void {\n        this.props.onOk(this.state.cron);\n        this.props.onClose();\n    }\n\n    setMode(mode: 'simple' | 'complex' | 'wizard'): void {\n        this.setState({ mode });\n    }\n\n    render(): JSX.Element {\n        return (\n            <Dialog\n                onClose={() => {}}\n                maxWidth=\"md\"\n                fullWidth\n                sx={{ '& .MuiDialog-paper': styles.dialogPaper }}\n                open={!0}\n                aria-labelledby=\"cron-dialog-title\"\n            >\n                <DialogTitle id=\"cron-dialog-title\">{this.props.title || I18n.t('ra_Define schedule...')}</DialogTitle>\n                <DialogContent style={{ height: '100%', overflow: 'hidden' }}>\n                    {(this.props.simple && this.props.complex) || (!this.props.simple && !this.props.complex) ? (\n                        <div>\n                            {!this.props.simple && !this.props.complex && !this.props.noWizard && (\n                                <>\n                                    <Radio\n                                        key=\"wizard\"\n                                        checked={this.state.mode === 'wizard'}\n                                        onChange={() => this.setMode('wizard')}\n                                    />\n                                    <label\n                                        onClick={() => this.setMode('wizard')}\n                                        style={this.state.mode !== 'wizard' ? { color: 'lightgrey' } : {}}\n                                    >\n                                        {I18n.t('sc_wizard')}\n                                    </label>\n                                </>\n                            )}\n\n                            {((!this.props.simple && !this.props.complex) || this.props.simple) && (\n                                <>\n                                    <Radio\n                                        key=\"simple\"\n                                        checked={this.state.mode === 'simple'}\n                                        onChange={() => this.setMode('simple')}\n                                    />\n                                    <label\n                                        onClick={() => this.setMode('simple')}\n                                        style={this.state.mode !== 'simple' ? { color: 'lightgrey' } : {}}\n                                    >\n                                        {I18n.t('sc_simple')}\n                                    </label>\n                                </>\n                            )}\n\n                            {((!this.props.simple && !this.props.complex) || this.props.complex) && (\n                                <>\n                                    <Radio\n                                        key=\"complex\"\n                                        checked={this.state.mode === 'complex'}\n                                        onChange={() => this.setMode('complex')}\n                                    />\n                                    <label\n                                        onClick={() => this.setMode('complex')}\n                                        style={this.state.mode !== 'complex' ? { color: 'lightgrey' } : {}}\n                                    >\n                                        {I18n.t('sc_cron')}\n                                    </label>\n                                </>\n                            )}\n                        </div>\n                    ) : null}\n\n                    {this.state.mode === 'simple' && (\n                        <SimpleCron\n                            cronExpression={this.state.cron}\n                            onChange={cron => this.setState({ cron })}\n                            language={I18n.getLanguage()}\n                        />\n                    )}\n                    {this.state.mode === 'wizard' && (\n                        <Schedule\n                            theme={this.props.theme}\n                            schedule={this.state.cron}\n                            onChange={(cron: string) => this.setState({ cron })}\n                        />\n                    )}\n                    {this.state.mode === 'complex' && (\n                        <ComplexCron\n                            cronExpression={this.state.cron}\n                            onChange={cron => this.setState({ cron })}\n                            language={I18n.getLanguage()}\n                        />\n                    )}\n                </DialogContent>\n                <DialogActions>\n                    <Button\n                        variant=\"contained\"\n                        onClick={() => this.handleOk()}\n                        color=\"primary\"\n                        startIcon={<IconOk />}\n                    >\n                        {this.props.ok || I18n.t('ra_Ok')}\n                    </Button>\n                    <Button\n                        variant=\"contained\"\n                        onClick={() => this.handleCancel()}\n                        color=\"grey\"\n                        startIcon={<IconCancel />}\n                    >\n                        {this.props.cancel || I18n.t('ra_Cancel')}\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        );\n    }\n}\n"]}
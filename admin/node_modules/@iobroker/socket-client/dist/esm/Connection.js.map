{"version":3,"file":"Connection.js","sourceRoot":"","sources":["../../src/Connection.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,qBAAqB,EAAE,MAAM,sBAAsB,CAAC;AAE7D,OAAO,EAAE,0BAA0B,EAAE,eAAe,EAAE,aAAa,EAAE,IAAI,EAAE,MAAM,YAAY,CAAC;AAE9F,IAAI,OAAQ,UAAkB,CAAC,OAAO,KAAK,WAAW,EAAE,CAAC;IACrD,8EAA8E;IAC9E,iEAAiE;IACjE,UAAU,CAAC,QAAQ,KAAK;QACpB,IAAI,EAAE,wBAAwB;QAC9B,QAAQ,EAAE,OAAO;QACjB,IAAI,EAAE,gBAAgB;QACtB,QAAQ,EAAE,GAAG;QACb,QAAQ,EAAE,WAAW;QACrB,MAAM,EAAE,GAAG,EAAE,GAAE,CAAC;KACnB,CAAC;IACF,iEAAiE;IACjE,UAAU,CAAC,YAAY,KAAK;QACxB,KAAK,EAAE,EAA+B;QACtC,OAAO,EAAE,CAAC,GAAW,EAAE,KAAa,EAAE,EAAE;YACpC,UAAU,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;QAC/C,CAAC;QACD,OAAO,EAAE,CAAC,GAAW,EAAiB,EAAE;YACpC,IAAI,GAAG,IAAI,UAAU,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;gBACvC,OAAO,UAAU,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC9C,CAAC;YACD,OAAO,IAAI,CAAC;QAChB,CAAC;QACD,UAAU,EAAE,CAAC,GAAW,EAAE,EAAE;YACxB,IAAI,GAAG,IAAI,UAAU,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;gBACvC,OAAO,UAAU,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC9C,CAAC;QACL,CAAC;KACJ,CAAC;IACF,UAAU,CAAC,cAAc,KAAK,UAAU,CAAC,YAAY,CAAC;IACtD,UAAU,CAAC,SAAS,KAAK;QACrB,QAAQ,EAAE,IAAI;KACJ,CAAC;AACnB,CAAC;AA2DD,gCAAgC;AAChC,MAAM,CAAN,IAAY,QASX;AATD,WAAY,QAAQ;IAChB,gCAAgC;IAChC,mDAAc,CAAA;IACd,4CAA4C;IAC5C,iDAAa,CAAA;IACb,8BAA8B;IAC9B,2DAAkB,CAAA;IAClB,mCAAmC;IACnC,yCAAS,CAAA;AACb,CAAC,EATW,QAAQ,KAAR,QAAQ,QASnB;AAED,MAAM,CAAN,IAAY,MAMX;AAND,WAAY,MAAM;IACd,8CAAoC,CAAA;IACpC,6CAAmC,CAAA;IACnC,6BAAmB,CAAA;IACnB,6CAAmC,CAAA;IACnC,yCAA+B,CAAA;AACnC,CAAC,EANW,MAAM,KAAN,MAAM,QAMjB;AAED,8DAA8D;AAC9D,MAAM,CAAC,MAAM,gBAAgB,GAAG,MAAM,CAAC,gBAAgB,CAAC;AACxD,2DAA2D;AAC3D,MAAM,CAAC,MAAM,aAAa,GAAG,MAAM,CAAC,aAAa,CAAC;AA2DlD,MAAM,QAAQ,GAAG,CAAC,UAAU,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;AAEhD,MAAM,OAAO,UAAU;IAIF,KAAK,CAAkB;IACxB,MAAM,CAAS;IACvB,eAAe,GAAkB,IAAI,CAAC;IAEtC,WAAW,GAAW,EAAE,CAAC;IACzB,SAAS,GAAY,KAAK,CAAC;IAC3B,UAAU,GAAY,KAAK,CAAC;IAC5B,YAAY,GAAY,IAAI,CAAC;IAC9B,cAAc,GAAY,KAAK,CAAC;IAChC,MAAM,GAAY,KAAK,CAAC;IACvB,SAAS,GAAmC,EAAE,CAAC;IAC/C,gBAAgB,CAER;IAEhB;;;;OAIG;IAEH,YAAY,KAA+B;QACvC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAE3C,oCAAoC;QACpC,IAAI,CAAC,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,OAAO,CAAC;aAC9F,QAAQ,EAAE;aACV,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC;QAExB,IAAI,CAAC,gBAAgB,EAAE;aAClB,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;aAC9B,KAAK,CAAC,CAAC,CAAC,EAAE;YACP,KAAK,CAAC,+CAA+C,CAAC,EAAE,CAAC,CAAC;QAC9D,CAAC,CAAC,CAAC;IACX,CAAC;IAEO,iBAAiB,CAAC,KAA+B;QACrD,OAAO;YACH,GAAG,KAAK;YACR,kDAAkD;YAClD,QAAQ,EAAE,KAAK,CAAC,QAAQ,IAAI,UAAU,CAAC,QAAQ,CAAC,QAAQ;YACxD,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,UAAU,CAAC,QAAQ,CAAC,QAAQ;YAChD,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC;YAC3F,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,IAAI,KAAK,EAAE,KAAK,CAAC;YACpD,UAAU,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,IAAI,IAAI,EAAE,IAAI,CAAC;YACpD,UAAU,EAAE,KAAK,CAAC,UAAU,IAAI,KAAK;YACrC,cAAc,EAAE,KAAK,CAAC,cAAc,IAAI,EAAE;YAC1C,gBAAgB,EAAE,KAAK,CAAC,gBAAgB,IAAI,KAAK;YACjD,YAAY,EAAE,KAAK,CAAC,YAAY,IAAI,IAAI;YACxC,mBAAmB,EAAE,KAAK,CAAC,mBAAmB,IAAI,IAAI;SACzD,CAAC;IACN,CAAC;IAEgB,gBAAgB,GAM7B,EAAE,CAAC;IACU,eAAe,GAO5B,EAAE,CAAC;IACU,iBAAiB,GAAgE,EAAE,CAAC;IAC7F,OAAO,GAAoC,EAAE,CAAC;IAC9C,MAAM,GAAmC,EAAE,CAAC;IAE7C,GAAG,GAAqB,IAAI,CAAC;IAC7B,QAAQ,GAAY,KAAK,CAAC;IACjC,0CAA0C;IACnC,WAAW,GAAY,KAAK,CAAC;IAEnB,oBAAoB,GAAqC,EAAE,CAAC;IAC5D,aAAa,GAAsC,EAAE,CAAC;IAE/D,kBAAkB,CAAsC;IACxD,kBAAkB,CAAsC;IACxD,gBAAgB,CAA0C;IAC1D,OAAO,CAAC,KAAU;QACtB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC;IACjD,CAAC;IAED,0BAA0B;IAChB,OAAO,CAAsD;IAE/D,qBAAqB,CAAiB;IAC7B,8BAA8B,GAAG,qBAAqB,EAAE,CAAC;IAE1E,gDAAgD;IACxC,sBAAsB,GAAwC,EAAE,CAAC;IAEzE,gCAAgC;IACf,SAAS,GAAiC,EAAE,CAAC;IAEpD,UAAU,GAAyC,IAAI,CAAC;IACxD,aAAa,GAAyC,IAAI,CAAC;IAE3D,aAAa,CAA+B;IACtD,iCAAiC;IACjC,IAAW,YAAY;QACnB,OAAO,IAAI,CAAC,aAAa,CAAC;IAC9B,CAAC;IAED,0DAA0D;IACnD,UAAU,GAAuB,IAAI,CAAC;IAE7C;;;;OAIG;IACH,MAAM,CAAC,KAAK;QACR,OAAQ,UAAkB,CAAC,SAAS,KAAK,SAAS,CAAC;IACvD,CAAC;IAEO,gBAAgB;QACpB,iBAAiB;QACjB,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAC7B,OAAO,IAAI,CAAC,qBAAqB,CAAC;QACtC,CAAC;QAED,qDAAqD;QACrD,IAAI,CAAC,qBAAqB,GAAG,IAAI,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,EAAE;YAC/D,qFAAqF;YACrF,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;gBACrB,OAAO,EAAE,CAAC;gBACV,OAAO;YACX,CAAC;YAED,yDAAyD;YACzD,IAAI,OAAQ,UAAkB,CAAC,EAAE,KAAK,WAAW,IAAI,OAAQ,UAAkB,CAAC,GAAG,KAAK,WAAW,EAAE,CAAC;gBAClG,iEAAiE;gBACjE,2DAA2D;gBAC3D,IAAI,OAAQ,UAAkB,CAAC,oBAAoB,KAAK,UAAU,EAAE,CAAC;oBAChE,UAAkB,CAAC,oBAAoB,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;gBAC9D,CAAC;qBAAM,CAAC;oBACJ,6BAA6B;oBAC7B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;wBAC3B,IAAK,UAAkB,CAAC,EAAE,IAAK,UAAkB,CAAC,GAAG,EAAE,CAAC;4BACpD,OAAO,OAAO,EAAE,CAAC;wBACrB,CAAC;wBACD,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC;oBACpB,CAAC;oBAED,MAAM,CAAC,IAAI,KAAK,CAAC,qCAAqC,CAAC,CAAC,CAAC;gBAC7D,CAAC;YACL,CAAC;iBAAM,CAAC;gBACJ,OAAO,EAAE,CAAC;YACd,CAAC;QACL,CAAC,CAAC,CAAC;QACH,OAAO,IAAI,CAAC,qBAAqB,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,KAAK,CAAC,WAAW;QACb,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,OAAO;QACX,CAAC;QAED,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;QAC3B,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;QAC3B,IAAI,QAAQ,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;QACtF,IAAI,IAAI,GAAG,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC;QAExC,IAAI,UAAU,CAAC,QAAQ,CAAC,QAAQ,KAAK,cAAc,IAAI,UAAU,CAAC,QAAQ,CAAC,QAAQ,KAAK,cAAc,EAAE,CAAC;YACrG,IAAI,GAAG,EAAE,CAAC;QACd,CAAC;aAAM,CAAC;YACJ,kEAAkE;YAClE,IAAK,UAAkB,CAAC,SAAS,EAAE,CAAC;gBAChC,MAAM,MAAM,GAAG,IAAI,UAAU,CAAC,GAAG,CAAE,UAAkB,CAAC,SAAS,CAAC,CAAC;gBACjE,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC;gBACvB,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;gBACnB,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;YAChD,CAAC;YACD,qBAAqB;YACrB,MAAM,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YAClC,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC;gBACb,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC;YACtC,CAAC;YAED,IAAI,UAAU,CAAC,KAAK,EAAE,EAAE,CAAC;gBACrB,sEAAsE;gBACtE,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAC9B,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;oBACnB,KAAK,CAAC,GAAG,EAAE,CAAC;oBACZ,KAAK,CAAC,GAAG,EAAE,CAAC;oBACZ,iFAAiF;oBACjF,IAAI,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC;wBAC7C,KAAK,CAAC,GAAG,EAAE,CAAC;oBAChB,CAAC;oBACD,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBACvB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;wBACtB,IAAI,IAAI,GAAG,CAAC;oBAChB,CAAC;gBACL,CAAC;YACL,CAAC;QACL,CAAC;QAED,MAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,QAAQ,MAAM,IAAI,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,MAAM,IAAI,EAAE,CAAC;QAE7E,MAAM,WAAW,GACb,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,CAAE,UAAkB,CAAC,EAAE,IAAK,UAAkB,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;QAEtF,IAAI,CAAC,OAAO,GAAG,WAAW,CAAC,GAAG,EAAE;YAC5B,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,WAAW,CAAC,CAAC,CAAC,GAAG,IAAI,YAAY;YACnE,KAAK,EAAE,SAAS;YAChB,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI;YACrB,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;YAC7B,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI;YACrB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK;SAC1B,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE;YACnC,sCAAsC;YACtC,UAAU,CAAC,gBAAgB,EAAE,CAAC,SAAS,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;YAEpE,MAAM,MAAM,GAAG,UAAU,CAAC,UAAU,EAAE,CAAC;YACvC,IAAI,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;gBAC1B,kCAAkC;gBAClC,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;gBACvB,IAAI,CAAC,UAAU,CACX;oBACI,YAAY,EAAE,MAAM,CAAC,YAAY;oBACjC,aAAa,EAAE,MAAM,CAAC,aAAa;oBACnC,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC;oBAClE,wBAAwB,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,wBAAwB,CAAC,OAAO,EAAE,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC;oBAC9F,UAAU,EAAE,QAAQ;iBACvB,EACD,MAAM,CAAC,YAAY,CACtB,CAAC;YACN,CAAC;YAED,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,2GAA2G;YAC3G,IAAI,SAAS,KAAK,IAAI,EAAE,CAAC;gBACrB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gBACtB,UAAU,CACN,GAAG,EAAE,CACD,IAAI,CAAC,UAAU,EAAE;qBACZ,IAAI,CAAC,IAAI,CAAC,EAAE;oBACT,MAAM,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oBACtD,MAAM,CAAC,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,GAAG,KAAK,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,GAAG,GAAG,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;oBACxF,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC;wBACZ,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;wBACvB,2CAA2C;wBAC3C,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;oBACpC,CAAC;yBAAM,CAAC;wBACJ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,EAAE,CACjD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CACpC,CAAC;oBACN,CAAC;gBACL,CAAC,CAAC;qBACD,KAAK,CAAC,CAAC,CAAC,EAAE,CACP,IAAI,CAAC,OAAO,CAAC;oBACT,OAAO,EAAE,CAAC,CAAC,QAAQ,EAAE;oBACrB,SAAS,EAAE,YAAY;iBAC1B,CAAC,CACL,EACT,GAAG,CACN,CAAC;YACN,CAAC;iBAAM,CAAC;gBACJ,4DAA4D;gBAC5D,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,EAAE;oBACjD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;gBACtC,CAAC,CAAC,CAAC;YACP,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,WAAW,EAAE,GAAG,EAAE;YAC9B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACxC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YAEtB,IAAI,IAAI,CAAC,cAAc,EAAE,CAAC;gBACtB,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;YACjC,CAAC;iBAAM,CAAC;gBACJ,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;gBACtB,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;YACtD,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,YAAY,EAAE,GAAG,EAAE;YAC/B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;YACxB,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAC7C,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,gBAAgB,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC;QAE7D,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC,OAAmB,EAAE,EAAE;YAC3C,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,CAAC;YAC5B,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;QAClD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,GAAQ,EAAE,EAAE;YAClC,IAAI,IAAY,CAAC;YAEjB,IAAI,GAAG,IAAI,SAAS,EAAE,CAAC;gBACnB,IAAI,GAAG,EAAE,CAAC;YACd,CAAC;iBAAM,IAAI,OAAO,GAAG,CAAC,QAAQ,KAAK,UAAU,EAAE,CAAC;gBAC5C,IAAI,GAAG,GAAG,CAAC,QAAQ,EAAE,CAAC;YAC1B,CAAC;iBAAM,CAAC;gBACJ,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;gBAC3B,OAAO,CAAC,KAAK,CAAC,2BAA2B,IAAI,EAAE,CAAC,CAAC;YACrD,CAAC;YAED,IAAI,IAAI,CAAC,QAAQ,CAAC,qBAAqB,CAAC,EAAE,CAAC;gBACvC,IAAI,CAAC,YAAY,EAAE,CAAC;YACxB,CAAC;iBAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,EAAE,CAAC;gBAC1C,OAAO,CAAC,KAAK,CAAC,2BAA2B,GAAG,EAAE,CAAC,CAAC;gBAChD,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;YACjC,CAAC;iBAAM,CAAC;gBACJ,OAAO,CAAC,KAAK,CAAC,iBAAiB,GAAG,EAAE,CAAC,CAAC;YAC1C,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,eAAe,EAAE,CAAC,GAAQ,EAAE,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,kBAAkB,GAAG,EAAE,CAAC,CAAC,CAAC;QAEvF,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,iBAAiB,EAAE,GAAG,CAAC,EAAE,CACrC,IAAI,CAAC,OAAO,CAAC;YACT,OAAO,EAAE,eAAe;YACxB,SAAS,EAAE,GAAG,CAAC,SAAS;YACxB,IAAI,EAAE,GAAG,CAAC,IAAI;YACd,EAAE,EAAE,GAAG,CAAC,EAAE,IAAI,EAAE;SACnB,CAAC,CACL,CAAC;QAEF,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE;YACxC,UAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC,EAAE,EAAE,KAAK,EAAE,EAAE;YACzC,UAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;QAEH,mBAAmB;QACnB,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,WAAW,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE;YAC9C,UAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;QACvE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,EAAE;YACjD,UAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;QAC7D,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE;YACtC,IAAI,CAAC,kBAAkB,EAAE,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;QACxC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE;YACtC,IAAI,CAAC,kBAAkB,EAAE,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;QACxC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,SAAS,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE;YACxC,IAAI,CAAC,gBAAgB,EAAE,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;QAEH,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC7B,CAAC;IAED;;OAEG;IACK,YAAY,CAAC,KAAc,EAAE,QAAiB;QAClD,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;YAClB,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC9B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAC3B,CAAC;QAED,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAEzB,IAAI,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;QACjC,CAAC;aAAM,CAAC;YACJ,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;gBACpB,KAAK,IAAI,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;oBAC3B,OAAO,CAAC,KAAK,CAAC,qBAAqB,CAAC,EAAE,CAAC,CAAC;gBAC5C,CAAC,CAAC,CAAC;YACP,CAAC;iBAAM,CAAC;gBACJ,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YAC5C,CAAC;YAED,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACtB,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;YAElD,IAAI,CAAC,sBAAsB,EAAE,CAAC;QAClC,CAAC;QAED,IAAI,CAAC,8BAA8B,CAAC,OAAO,EAAE,CAAC;IAClD,CAAC;IAED,MAAM,CAAC,UAAU;QACb,IAAI,WAAW,GAA8B,UAAU,CAAC,cAAc,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QAC7F,MAAM,YAAY,GAAG,CAAC,WAAW,CAAC;QAClC,IAAI,CAAC,WAAW,EAAE,CAAC;YACf,WAAW,GAAG,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QAChE,CAAC;QACD,IAAI,CAAC,WAAW,EAAE,CAAC;YACf,OAAO,IAAI,CAAC;QAChB,CAAC;QAED,MAAM,CAAC,aAAa,EAAE,wBAAwB,EAAE,YAAY,EAAE,UAAU,EAAE,KAAK,CAAC,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC1G,MAAM,cAAc,GAAG,IAAI,IAAI,CAAC,wBAAwB,CAAC,CAAC;QAC1D,IAAI,cAAc,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC;YACxC,wBAAwB;YACxB,OAAO,IAAI,CAAC;QAChB,CAAC;QACD,OAAO;YACH,aAAa;YACb,wBAAwB,EAAE,cAAc;YACxC,YAAY;YACZ,UAAU,EAAE,IAAI,IAAI,CAAC,UAAU,CAAC;YAChC,KAAK;YACL,YAAY;SACf,CAAC;IACN,CAAC;IAED,MAAM,CAAC,gBAAgB,CAAC,IAAoB,EAAE,YAAqB,EAAE,KAAc;QAC/E,MAAM,QAAQ,GAAG,GAAG,IAAI,CAAC,aAAa,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,CAAC,WAAW,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;QACrO,IAAI,YAAY,EAAE,CAAC;YACf,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;QAC5D,CAAC;aAAM,CAAC;YACJ,UAAU,CAAC,cAAc,CAAC,OAAO,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;QAC9D,CAAC;IACL,CAAC;IAEM,UAAU,CAAC,IAAoB,EAAE,YAAqB;QACzD,UAAU,CAAC,gBAAgB,CAAC,IAAI,EAAE,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IACjE,CAAC;IAED,MAAM,CAAC,kBAAkB;QACrB,UAAU,CAAC,YAAY,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;QACjD,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;IACvD,CAAC;IAED;;;;;OAKG;IACI,YAAY,CAAC,YAAqB,EAAE,MAAgB;QACvD,MAAM,MAAM,GAAG,UAAU,CAAC,UAAU,EAAE,CAAC;QACvC,IAAI,MAAM,EAAE,CAAC;YACT,IAAI,MAAM,EAAE,CAAC;gBACT,UAAU,CAAC,kBAAkB,EAAE,CAAC;YACpC,CAAC;iBAAM,IAAI,MAAM,CAAC,YAAY,KAAK,YAAY,IAAI,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC,MAAM,EAAE,CAAC;gBAC9E,IAAI,MAAM,CAAC,YAAY,EAAE,CAAC;oBACtB,UAAU,CAAC,YAAY,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;gBACrD,CAAC;qBAAM,CAAC;oBACJ,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;gBACvD,CAAC;YACL,CAAC;QACL,CAAC;IACL,CAAC;IAEO,oBAAoB,GAAG,CAAC,KAAmB,EAAQ,EAAE;QACzD,yMAAyM;QACzM,IAAI,KAAK,CAAC,GAAG,KAAK,YAAY,EAAE,CAAC;YAC7B,MAAM,MAAM,GAAG,UAAU,CAAC,UAAU,EAAE,CAAC;YACvC,IAAI,MAAM,EAAE,CAAC;gBACT,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,MAAM,4BAA4B,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC;gBACjF,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;YACpD,CAAC;QACL,CAAC;IACL,CAAC,CAAC;IAEM,qBAAqB,CAAC,WAAmB;QAC7C,gGAAgG;QAChG,IAAI,IAAI,CAAC,eAAe,KAAK,WAAW,EAAE,CAAC;YACvC,IAAI,CAAC,eAAe,GAAG,WAAW,CAAC;YACnC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,uBAAuB,EAAE,WAAW,EAAE,CAAC,GAAkB,EAAE,OAAiB,EAAQ,EAAE;gBACpG,IAAI,GAAG,EAAE,CAAC;oBACN,OAAO,CAAC,KAAK,CAAC,WAAW,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,2CAA2C,GAAG,EAAE,CAAC,CAAC;oBACnG,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;gBACjC,CAAC;qBAAM,IAAI,CAAC,OAAO,EAAE,CAAC;oBAClB,OAAO,CAAC,KAAK,CAAC,WAAW,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,wCAAwC,CAAC,CAAC;oBAC3F,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;gBACjC,CAAC;qBAAM,CAAC;oBACJ,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,gCAAgC,WAAW,EAAE,CAAC,CAAC;gBAClG,CAAC;YACL,CAAC,CAAC,CAAC;QACP,CAAC;QAED,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAClC,CAAC;IAEO,aAAa,CAAC,cAA4B,EAAE,aAAuB;QACvE,IAAI,CAAC,cAAc,EAAE,CAAC;YAClB,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,kDAAkD,CAAC,CAAC;YACpG,mDAAmD;YACnD,UAAU,CAAC,GAAG,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAE,GAAG,CAAC,CAAC;YACpD,OAAO;QACX,CAAC;QAED,IAAI,aAAa,IAAI,CAAC,cAAc,CAAC,KAAK,IAAI,cAAc,CAAC,KAAK,KAAK,IAAI,CAAC,MAAM,EAAE,CAAC;YACjF,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,gCAAgC,CAAC,CAAC;YAClF,IAAI,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC;gBAC1B,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,oBAAoB,CAAC,CAAC;gBACtE,6DAA6D;gBAC7D,KAAK,CAAC,eAAe,EAAE;oBACnB,MAAM,EAAE,MAAM;oBACd,OAAO,EAAE;wBACL,cAAc,EAAE,mCAAmC;qBACtD;oBACD,IAAI,EAAE,0CAA0C,cAAc,CAAC,aAAa,oCAAoC,cAAc,CAAC,YAAY,EAAE;iBAChJ,CAAC;qBACG,IAAI,CAAC,QAAQ,CAAC,EAAE;oBACb,IAAI,QAAQ,CAAC,EAAE,EAAE,CAAC;wBACd,OAAO,QAAQ,CAAC,IAAI,EAAE,CAAC;oBAC3B,CAAC;oBACD,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC;gBACnD,CAAC,CAAC;qBACD,IAAI,CAAC,CAAC,IAAoB,EAAQ,EAAE;oBACjC,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;wBACpB,OAAO,CAAC,GAAG,CACP,YAAY,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,yBAAyB,IAAI,CAAC,YAAY,EAAE,CACnF,CAAC;wBACF,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,cAAc,CAAC,YAAY,CAAC,CAAC;wBAEnD,IAAI,CAAC,gBAAgB,EAAE,CAAC;wBAExB,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;oBAClD,CAAC;yBAAM,CAAC;wBACJ,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;oBAC/C,CAAC;gBACL,CAAC,CAAC;qBACD,KAAK,CAAC,GAAG,CAAC,EAAE;oBACT,OAAO,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,2BAA2B,GAAG,EAAE,CAAC,CAAC;oBACnF,IAAI,CAAC,gBAAgB,EAAE,CAAC;oBACxB,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;oBAC/C,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oBACnB,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;gBACjC,CAAC,CAAC,CAAC;YACX,CAAC;iBAAM,CAAC;gBACJ,OAAO,CAAC,GAAG,CACP,YAAY,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,kEAAkE,CACzG,CAAC;gBACF,iEAAiE;gBACjE,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAClC,CAAC;QACL,CAAC;aAAM,IAAI,IAAI,CAAC,eAAe,KAAK,cAAc,CAAC,YAAY,EAAE,CAAC;YAC9D,IAAI,CAAC,qBAAqB,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;QAC5D,CAAC;IACL,CAAC;IAED;;;;OAIG;IACH,gBAAgB;QACZ,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QACvB,MAAM,IAAI,GAAG,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;QAEpE,IAAI,IAAI,EAAE,CAAC;YACP,IAAI,CAAC;gBACD,MAAM,QAAQ,GAAuC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACtE,kEAAkE;gBAClE,IAAI,GAAG,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC;oBACxB,OAAO,KAAK,CAAC;gBACjB,CAAC;gBACD,0DAA0D;YAC9D,CAAC;YAAC,MAAM,CAAC;gBACL,SAAS;YACb,CAAC;QACL,CAAC;QAED,qDAAqD;QACrD,MAAM,OAAO,GAAuC;YAChD,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,MAAM,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,6BAA6B;SACzD,CAAC;QAEF,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC,qBAAqB,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;QAChF,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,4EAA4E;IAC5E,gBAAgB;QACZ,MAAM,IAAI,GAAG,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;QACpE,IAAI,IAAI,EAAE,CAAC;YACP,IAAI,CAAC;gBACD,MAAM,QAAQ,GAAuC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACtE,gEAAgE;gBAChE,IAAI,QAAQ,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM,EAAE,CAAC;oBAClC,UAAU,CAAC,YAAY,CAAC,UAAU,CAAC,qBAAqB,CAAC,CAAC;gBAC9D,CAAC;YACL,CAAC;YAAC,MAAM,CAAC;gBACL,kDAAkD;gBAClD,UAAU,CAAC,YAAY,CAAC,UAAU,CAAC,qBAAqB,CAAC,CAAC;YAC9D,CAAC;QACL,CAAC;IACL,CAAC;IAEO,sBAAsB;QAC1B,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YACjC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC9B,CAAC;QACD,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,MAAM,MAAM,GAAG,UAAU,CAAC,UAAU,EAAE,CAAC;YACvC,IAAI,MAAM,EAAE,CAAC;gBACT,MAAM,oBAAoB,GAAG,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;gBACzD,2DAA2D;gBAC3D,IAAI,oBAAoB,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,MAAM,EAAE,CAAC;oBAC7C,MAAM,aAAa,GAAG,oBAAoB,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC;oBAChE,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,4BAA4B,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC;oBACjG,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC;wBACxB,OAAO,CAAC,GAAG,CACP,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,gEAAgE,CACrG,CAAC;wBACF,mDAAmD;wBACnD,UAAU,CACN,GAAG,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,EAClC,IAAI,CAAC,GAAG,EAAE,GAAG,oBAAoB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,oBAAoB,GAAG,IAAI,CAAC,GAAG,EAAE,CAC9E,CAAC;oBACN,CAAC;yBAAM,IACH,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC,MAAM;wBAC5B,oGAAoG;wBACpG,aAAa,EACf,CAAC;wBACC,IAAI,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC,MAAM,EAAE,CAAC;4BAC/B,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,iCAAiC,CAAC,CAAC;wBACrF,CAAC;6BAAM,CAAC;4BACJ,OAAO,CAAC,GAAG,CACP,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,iEAAiE,CACtG,CAAC;wBACN,CAAC;wBACD,sEAAsE;wBACtE,IAAI,IAAI,CAAC,KAAK,CAAC,mBAAmB,EAAE,CAAC;4BACjC,OAAO,CAAC,GAAG,CACP,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,6CAA6C,CAClF,CAAC;4BACF,0CAA0C;4BAC1C,KAAK,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;gCACrE,IAAI,OAAO,EAAE,CAAC;oCACV,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,2BAA2B,CAAC,CAAC;oCAC3E,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;gCAC9C,CAAC;qCAAM,CAAC;oCACJ,OAAO,CAAC,GAAG,CACP,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,mDAAmD,CACxF,CAAC;oCACF,mDAAmD;oCACnD,UAAU,CACN,GAAG,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,EAClC,IAAI,CAAC,GAAG,EAAE,GAAG,oBAAoB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,oBAAoB,GAAG,IAAI,CAAC,GAAG,EAAE,CAC9E,CAAC;gCACN,CAAC;4BACL,CAAC,CAAC,CAAC;wBACP,CAAC;6BAAM,CAAC;4BACJ,OAAO,CAAC,GAAG,CACP,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,wDAAwD,CAC7F,CAAC;4BACF,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;wBAC9C,CAAC;oBACL,CAAC;yBAAM,IAAI,IAAI,CAAC,eAAe,KAAK,MAAM,CAAC,YAAY,EAAE,CAAC;wBACtD,OAAO,CAAC,GAAG,CACP,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,oFAAoF,CACzH,CAAC;wBACF,wGAAwG;wBACxG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;oBAC/B,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,GAAG,CACP,UAAU,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,qHAAqH,CAC1J,CAAC;wBACF,mFAAmF;wBACnF,IAAI,CAAC,aAAa,GAAG,UAAU,CAAC,GAAG,EAAE;4BACjC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;4BAC1B,IAAI,CAAC,sBAAsB,EAAE,CAAC;wBAClC,CAAC,EAAE,KAAK,CAAC,CAAC;oBACd,CAAC;gBACL,CAAC;qBAAM,CAAC;oBACJ,IAAI,CAAC,aAAa,GAAG,UAAU,CAC3B,GAAG,EAAE;wBACD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;wBAC1B,IAAI,CAAC,sBAAsB,EAAE,CAAC;oBAClC,CAAC,EACD,oBAAoB,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,MAAM,GAAG,OAAO;wBAChD,CAAC,CAAC,OAAO;wBACT,CAAC,CAAC,oBAAoB,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,MAAM,CACnD,CAAC;gBACN,CAAC;YACL,CAAC;QACL,CAAC;IACL,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,OAAO;QACV,IACI,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,eAAe,CAAC;YACtD,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,EACtD,CAAC;YACC,OAAO,IAAI,CAAC;QAChB,CAAC;QACD,IAAI,OAAQ,UAAkB,CAAC,SAAS,KAAK,WAAW,EAAE,CAAC;YACvD,OAAO,KAAK,CAAC;QACjB,CAAC;QACD,OAAO,CACF,UAAkB,CAAC,SAAS,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAK,UAAkB,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,CAC/G,CAAC;IACN,CAAC;IAED;;;;OAIG;IACH,WAAW;QACP,OAAO,IAAI,CAAC,SAAS,CAAC;IAC1B,CAAC;IAED;;OAEG;IACH,sBAAsB;QAClB,OAAO,IAAI,CAAC,8BAA8B,CAAC;IAC/C,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,kBAAkB;QAC5B,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,EAAE,CAAC,GAAG,EAAE,GAAsB,EAAQ,EAAE;oBAC1E,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC;oBACzB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED,kFAAkF;IAC1E,KAAK,CAAC,QAAQ;QAClB,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YACd,OAAO;QACX,CAAC;QACD,MAAM,WAAW,GAAG,EAAE,CAAC;QACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,WAAW,EAAE,CAAC,EAAE,EAAE,CAAC;YACpC,KAAK,IAAI,CAAC,UAAU,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,qBAAqB,CAAC,EAAE,CAAC,CAAC,CAAC;YAC3E,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;gBACd,OAAO;YACX,CAAC;YACD,uCAAuC;YACvC,MAAM,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QACnD,CAAC;IACL,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,UAAU;QACpB,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YACd,OAAO;QACX,CAAC;QAED,2BAA2B;QAC3B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;YAC3B,IAAI,CAAC;gBACD,IAAI,CAAC,GAAG,GAAG,MAAM,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAC/C,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;gBACT,IAAI,CAAC,OAAO,CAAC,iCAAiC,CAAC,EAAE,CAAC,CAAC;gBACnD,OAAO;YACX,CAAC;QACL,CAAC;QAED,qCAAqC;QACrC,IAAI,CAAC;YACD,IACI,IAAI,CAAC,KAAK,CAAC,UAAU;gBACrB,CAAC,UAAU,CAAC,KAAK,EAAE;gBACnB,CAAC,CAAE,UAAkB,CAAC,YAAY,IAAK,UAAkB,CAAC,YAAY,KAAK,kBAAkB,CAAC,EAChG,CAAC;gBACC,IAAI,CAAC,aAAa,GAAG,MAAM,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC7D,CAAC;iBAAM,CAAC;gBACJ,IAAI,CAAC,aAAa,GAAG,MAAM,IAAI,CAAC,eAAe,EAAE,CAAC;YACtD,CAAC;QACL,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACT,IAAI,CAAC,OAAO,CAAC,8BAA8B,CAAC,EAAE,CAAC,CAAC;YAChD,OAAO;QACX,CAAC;QAED,6BAA6B;QAC7B,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,QAAQ,CAAC;YACtD,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;gBACnB,IAAI,CAAC,UAAU,GAAG,CAAE,UAAU,CAAC,SAAiB,CAAC,YAAY,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAQ,CAAC;gBACvG,4DAA4D;gBAC5D,mCAAmC;gBACnC,IAAI,oCAAoC,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;oBAC7D,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAQ,CAAC;gBAC7D,CAAC;qBAAM,IAAI,CAAC,yCAAyC,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;oBAC1E,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBAC3B,CAAC;gBACD,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC;YACzD,CAAC;QACL,CAAC;QACD,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAEzC,uBAAuB;QACvB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC5C,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;QAE1B,8BAA8B;QAC9B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,mBAAmB,EAAE,CAAC;YAClC,IAAI,CAAC,OAAO,GAAG,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC;QAC3C,CAAC;aAAM,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;YAC/B,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QACtB,CAAC;aAAM,CAAC;YACJ,IAAI,CAAC,OAAO,GAAG,EAAE,eAAe,EAAE,IAAI,CAAC,aAAa,EAAE,CAAC;QAC3D,CAAC;QAED,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QACxC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YACpB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACvC,CAAC;IACL,CAAC;IAED;;OAEG;IACK,YAAY;QAChB,IAAI,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC;YAChD,UAAU,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,UAAU,CAAC,QAAQ,CAAC,QAAQ,KAAK,UAAU,CAAC,QAAQ,CAAC,IAAI,GAAG,UAAU,CAAC,QAAQ,CAAC,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;QAC1J,CAAC;aAAM,CAAC;YACJ,UAAU,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,UAAU,CAAC,QAAQ,CAAC,QAAQ,KAAK,UAAU,CAAC,QAAQ,CAAC,IAAI,GAAG,UAAU,CAAC,QAAQ,CAAC,QAAQ,eAAe,kBAAkB,CAAC,UAAU,CAAC,QAAQ,CAAC,MAAM,GAAG,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;QACrN,CAAC;IACL,CAAC;IAiBD,KAAK,CAAC,cAAc,CAChB,GAAG,IAG2D;QAE9D,IAAI,EAAqB,CAAC;QAC1B,IAAI,MAAe,CAAC;QACpB,IAAI,EAA0D,CAAC;QAC/D,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YACpB,CAAC,EAAE,EAAE,MAAM,EAAE,EAAE,CAAC,GAAG,IAAI,CAAC;QAC5B,CAAC;aAAM,CAAC;YACJ,CAAC,EAAE,EAAE,EAAE,CAAC,GAAG,IAAI,CAAC;YAChB,MAAM,GAAG,KAAK,CAAC;QACnB,CAAC;QACD,IAAI,GAAa,CAAC;QAClB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YACrB,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC;QACf,CAAC;aAAM,CAAC;YACJ,GAAG,GAAG,EAAE,CAAC;QACb,CAAC;QAED,IAAI,OAAO,EAAE,KAAK,UAAU,EAAE,CAAC;YAC3B,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;QACpE,CAAC;QACD,MAAM,WAAW,GAAa,EAAE,CAAC;QACjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAClC,MAAM,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YACnB,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC9B,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,GAAG;oBACzB,GAAG,EAAE,IAAI,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;oBACnC,GAAG,EAAE,CAAC,EAAE,CAAC;iBACZ,CAAC;gBACF,IAAI,EAAE,KAAK,IAAI,CAAC,WAAW,EAAE,CAAC;oBAC1B,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC1B,CAAC;YACL,CAAC;iBAAM,CAAC;gBACJ,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAC5F,CAAC;QACL,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;YAClB,OAAO;QACX,CAAC;QAED,IAAI,WAAW,CAAC,MAAM,EAAE,CAAC;YACrB,iCAAiC;YACjC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;QAChD,CAAC;QAED,+EAA+E;QAC/E,IAAI,MAAM,EAAE,CAAC;YACT,IAAI,MAA0B,CAAC;YAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBAClC,IAAI,CAAC;oBACD,+BAA+B;oBAC/B,MAAM,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC/C,CAAC;gBAAC,OAAO,CAAC,EAAE,CAAC;oBACT,OAAO,CAAC,KAAK,CAAC,0BAA0B,GAAG,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;oBACzE,MAAM,GAAG,SAAS,CAAC;gBACvB,CAAC;gBACD,IAAI,MAAM,IAAI,SAAS,EAAE,CAAC;oBACrB,EAA+B,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;gBACrD,CAAC;YACL,CAAC;QACL,CAAC;aAAM,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;YAC5C,IAAI,MAAkD,CAAC;YACvD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBAClC,IAAI,CAAC;oBACD,MAAM,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBACjD,CAAC;gBAAC,OAAO,CAAC,EAAE,CAAC;oBACT,OAAO,CAAC,KAAK,CAAC,4BAA4B,GAAG,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;oBAC3E,OAAO;gBACX,CAAC;gBACD,IAAI,MAAM,EAAE,CAAC;oBACT,KAAK,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC;wBAC/C,MAAM,YAAY,GAAI,EAAkC,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;wBACpE,IAAI,YAAY,YAAY,OAAO,EAAE,CAAC;4BAClC,KAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,qCAAqC,CAAC,EAAE,CAAC,CAAC,CAAC;wBAC1F,CAAC;oBACL,CAAC;gBACL,CAAC;YACL,CAAC;QACL,CAAC;aAAM,CAAC;YACJ,IAAI,CAAC;gBACD,MAAM,MAAM,GAAG,MAAM,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC7F,IAAI,MAAM,EAAE,CAAC;oBACT,KAAK,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC;wBAC/C,MAAM,YAAY,GAAI,EAAkC,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;wBACpE,IAAI,YAAY,YAAY,OAAO,EAAE,CAAC;4BAClC,KAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,qCAAqC,CAAC,EAAE,CAAC,CAAC,CAAC;wBAC1F,CAAC;oBACL,CAAC;gBACL,CAAC;YACL,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;gBACT,OAAO,CAAC,KAAK,CAAC,oBAAoB,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC;gBACnE,OAAO;YACX,CAAC;QACL,CAAC;IACL,CAAC;IAED;;;;;OAKG;IACH,KAAK,CAAC,mBAAmB,CAAC,EAAqB,EAAE,EAA+B;QAC5E,OAAO,IAAI,CAAC,cAAc,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACvC,CAAC;IAED;;;;;OAKG;IACH,gBAAgB,CAAC,EAAqB,EAAE,EAAgC;QACpE,IAAI,GAAa,CAAC;QAClB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YACrB,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC;QACf,CAAC;aAAM,CAAC;YACJ,GAAG,GAAG,EAAE,CAAC;QACb,CAAC;QACD,MAAM,aAAa,GAAG,EAAE,CAAC;QACzB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAClC,MAAM,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAEnB,IAAI,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC7B,MAAM,GAAG,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;gBACvC,IAAI,EAAE,EAAE,CAAC;oBACL,MAAM,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;oBAChC,GAAG,KAAK,CAAC,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;gBACzC,CAAC;qBAAM,CAAC;oBACJ,GAAG,CAAC,GAAG,GAAG,EAAE,CAAC;gBACjB,CAAC;gBAED,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,EAAE,CAAC;oBACnB,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;oBAClC,IAAI,GAAG,KAAK,IAAI,CAAC,WAAW,EAAE,CAAC;wBAC3B,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBAC5B,CAAC;gBACL,CAAC;YACL,CAAC;QACL,CAAC;QACD,IAAI,IAAI,CAAC,SAAS,IAAI,aAAa,CAAC,MAAM,EAAE,CAAC;YACzC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,CAAC,CAAC;QAC1C,CAAC;IACL,CAAC;IAED;;;;;;;;;OASG;IACH,eAAe,CAAC,EAAqB,EAAE,EAAuB;QAC1D,IAAI,GAAa,CAAC;QAClB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YACrB,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC;QACf,CAAC;aAAM,CAAC;YACJ,GAAG,GAAG,EAAE,CAAC;QACb,CAAC;QAED,IAAI,OAAO,EAAE,KAAK,UAAU,EAAE,CAAC;YAC3B,MAAM,IAAI,KAAK,CAAC,+CAA+C,CAAC,CAAC;QACrE,CAAC;QAED,MAAM,WAAW,GAAa,EAAE,CAAC;QACjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAClC,MAAM,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YACnB,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC/B,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,GAAG;oBAC1B,GAAG,EAAE,IAAI,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;oBACnC,GAAG,EAAE,CAAC,EAAE,CAAC;iBACZ,CAAC;gBACF,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC1B,CAAC;iBAAM,CAAC;gBACJ,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAC9F,CAAC;QACL,CAAC;QAED,IAAI,IAAI,CAAC,SAAS,IAAI,WAAW,CAAC,MAAM,EAAE,CAAC;YACvC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAC;QACvD,CAAC;QAED,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC7B,CAAC;IAED;;;;OAIG;IACH;;;;;OAKG;IACH,iBAAiB,CAAC,EAAqB,EAAE,EAAwB;QAC7D,IAAI,GAAa,CAAC;QAClB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YACrB,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC;QACf,CAAC;aAAM,CAAC;YACJ,GAAG,GAAG,EAAE,CAAC;QACb,CAAC;QACD,MAAM,aAAa,GAAa,EAAE,CAAC;QACnC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAClC,MAAM,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YACnB,IAAI,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC9B,MAAM,GAAG,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;gBACxC,IAAI,EAAE,EAAE,CAAC;oBACL,MAAM,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;oBAChC,GAAG,KAAK,CAAC,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;gBACzC,CAAC;qBAAM,CAAC;oBACJ,GAAG,CAAC,GAAG,GAAG,EAAE,CAAC;gBACjB,CAAC;gBAED,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,EAAE,CAAC;oBACnB,OAAO,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;oBACnC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC5B,CAAC;YACL,CAAC;QACL,CAAC;QACD,IAAI,IAAI,CAAC,SAAS,IAAI,aAAa,CAAC,MAAM,EAAE,CAAC;YACzC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,EAAE,aAAa,CAAC,CAAC;QAC3D,CAAC;QACD,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC7B,CAAC;IAED;;;;;OAKG;IACK,YAAY,CAAC,EAAU,EAAE,GAAuC;QACpE,4BAA4B;QAE5B,4CAA4C;QAC5C,IAAI,MAA6B,CAAC;QAClC,IAAI,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YACnB,MAAM,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;QACtD,CAAC;QAED,IAAI,OAAO,GAAG,KAAK,CAAC;QACpB,IAAI,GAAG,EAAE,CAAC;YACN,2CAA2C;YAE3C,4CAA4C;YAC5C,IAAK,GAAW,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;gBACvC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAS,CAAC,IAAI,GAAI,GAAW,CAAC,IAAI,CAAC;YACvD,CAAC;YAED,+BAA+B;YAC/B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC;gBAChF,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC;gBACvB,OAAO,GAAG,IAAI,CAAC;YACnB,CAAC;QACL,CAAC;aAAM,IAAI,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YAC1B,yBAAyB;YACzB,OAAO,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YACxB,OAAO,GAAG,IAAI,CAAC;QACnB,CAAC;QAED,kCAAkC;QAClC,KAAK,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;YAC9D,IAAI,GAAG,KAAK,EAAE,IAAI,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC;gBACjC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;oBACjB,IAAI,CAAC;wBACD,MAAM,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,MAAM,CAAC,CAAC;wBACzC,IAAI,YAAY,YAAY,OAAO,EAAE,CAAC;4BAClC,KAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,sCAAsC,CAAC,EAAE,CAAC,CAAC,CAAC;wBAC3F,CAAC;oBACL,CAAC;oBAAC,OAAO,CAAC,EAAE,CAAC;wBACT,OAAO,CAAC,KAAK,CAAC,sCAAsC,CAAC,EAAE,CAAC,CAAC;oBAC7D,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;QACL,CAAC;QAED,wCAAwC;QACxC,IAAI,OAAO,EAAE,CAAC;YACV,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;YAC1D,IAAI,YAAY,YAAY,OAAO,EAAE,CAAC;gBAClC,KAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,sCAAsC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC3F,CAAC;QACL,CAAC;IACL,CAAC;IAED;;;;;OAKG;IACK,WAAW,CAAC,EAAU,EAAE,KAAwC;QACpE,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC;YACrD,IAAI,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC;gBACnB,KAAK,MAAM,EAAE,IAAI,GAAG,CAAC,GAAG,EAAE,CAAC;oBACvB,IAAI,CAAC;wBACD,MAAM,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,KAAK,IAAI,IAAI,CAAQ,CAAC,CAAC;wBACpD,IAAI,YAAY,YAAY,OAAO,EAAE,CAAC;4BAClC,KAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,qCAAqC,CAAC,EAAE,CAAC,CAAC,CAAC;wBAC1F,CAAC;oBACL,CAAC;oBAAC,OAAO,CAAC,EAAE,CAAC;wBACT,OAAO,CAAC,KAAK,CAAC,sCAAsC,CAAC,EAAE,CAAC,CAAC;oBAC7D,CAAC;gBACL,CAAC;YACL,CAAC;QACL,CAAC;IACL,CAAC;IAED;;;;;;OAMG;IACK,eAAe,CAAC,WAAmB,EAAE,cAAsB,EAAE,IAAS;QAC1E,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,EAAE;YACvD,IAAI,GAAG,CAAC,WAAW,KAAK,WAAW,EAAE,CAAC;gBAClC,MAAM,YAAY,GAAG,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,cAAc,EAAE,WAAW,CAAC,CAAC;gBACrE,IAAI,YAAY,YAAY,OAAO,EAAE,CAAC;oBAClC,KAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,yCAAyC,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC9F,CAAC;YACL,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACK,UAAU,CAAC,EAAU,EAAE,QAAgB,EAAE,IAAmB;QAChE,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC;YACpD,IAAI,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,GAAG,CAAC,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;gBAC1D,KAAK,MAAM,EAAE,IAAI,GAAG,CAAC,GAAG,EAAE,CAAC;oBACvB,IAAI,CAAC;wBACD,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;oBAC3B,CAAC;oBAAC,OAAO,CAAC,EAAE,CAAC;wBACT,OAAO,CAAC,KAAK,CAAC,oCAAoC,CAAC,EAAE,CAAC,CAAC;oBAC3D,CAAC;gBACL,CAAC;YACL,CAAC;QACL,CAAC;IACL,CAAC;IAED;;;;;;OAMG;IACH,KAAK,CAAC,cAAc,CAAC,EAAU,EAAE,WAA8B,EAAE,EAAqB;QAClF,IAAI,OAAO,EAAE,KAAK,UAAU,EAAE,CAAC;YAC3B,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;QACpE,CAAC;QAED,IAAI,YAAsB,CAAC;QAC3B,IAAI,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC;YAC7B,YAAY,GAAG,WAAW,CAAC;QAC/B,CAAC;aAAM,CAAC;YACJ,YAAY,GAAG,CAAC,WAAW,CAAC,CAAC;QACjC,CAAC;QAED,MAAM,WAAW,GAAG,EAAE,CAAC;QACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC3C,MAAM,OAAO,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,GAAG,GAAG,GAAG,EAAE,MAAM,OAAO,EAAE,CAAC;YAEjC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC7B,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,GAAG;oBACxB,KAAK,EAAE,IAAI,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;oBACpC,cAAc,EAAE,IAAI,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;oBAClD,GAAG,EAAE,CAAC,EAAE,CAAC;iBACZ,CAAC;gBACF,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC9B,CAAC;iBAAM,CAAC;gBACJ,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAC1F,CAAC;QACL,CAAC;QACD,IAAI,IAAI,CAAC,SAAS,IAAI,WAAW,CAAC,MAAM,EAAE,CAAC;YACvC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,EAAE,WAAW,CAAC,CAAC;QACzD,CAAC;QAED,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC7B,CAAC;IAED;;;;;;OAMG;IACH,gBAAgB,CAAC,EAAU,EAAE,WAA8B,EAAE,EAAsB;QAC/E,IAAI,YAAsB,CAAC;QAC3B,IAAI,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC;YAC7B,YAAY,GAAG,WAAW,CAAC;QAC/B,CAAC;aAAM,CAAC;YACJ,YAAY,GAAG,CAAC,WAAW,CAAC,CAAC;QACjC,CAAC;QACD,MAAM,aAAa,GAAG,EAAE,CAAC;QACzB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC3C,MAAM,OAAO,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,GAAG,GAAG,GAAG,EAAE,MAAM,OAAO,EAAE,CAAC;YACjC,IAAI,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC5B,MAAM,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;gBACtC,IAAI,EAAE,EAAE,CAAC;oBACL,MAAM,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;oBAChC,GAAG,KAAK,CAAC,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;gBACzC,CAAC;qBAAM,CAAC;oBACJ,GAAG,CAAC,GAAG,GAAG,EAAE,CAAC;gBACjB,CAAC;gBAED,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,EAAE,CAAC;oBACnB,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;oBACjC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBAChC,CAAC;YACL,CAAC;QACL,CAAC;QACD,IAAI,IAAI,CAAC,SAAS,IAAI,aAAa,CAAC,MAAM,EAAE,CAAC;YACzC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,EAAE,EAAE,aAAa,CAAC,CAAC;QAC7D,CAAC;IACL,CAAC;IAED,+DAA+D;IACrD,KAAK,CAAC,OAAO,CAAI,EACvB,QAAQ,EACR,WAAW,EACX,cAAc,EACd,SAAS,EACT,YAAY,EACZ,eAAe;IACf,eAAe;IACf,QAAQ,GACQ;QAChB,sCAAsC;QAEtC,wDAAwD;QACxD,IAAI,YAAY,IAAI,UAAU,CAAC,KAAK,EAAE,EAAE,CAAC;YACrC,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;QACvD,CAAC;QAED,qCAAqC;QACrC,IAAI,QAAQ,IAAI,CAAC,WAAW,IAAI,QAAQ,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;YACzD,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;QACpC,CAAC;QAED,qCAAqC;QACrC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;YAClB,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC;QAC3D,CAAC;QAED,+CAA+C;QAC/C,IAAI,eAAe,EAAE,MAAM,EAAE,CAAC;YAC1B,KAAK,MAAM,OAAO,IAAI,eAAe,EAAE,CAAC;gBACpC,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC;oBAC/C,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;gBAC1C,CAAC;YACL,CAAC;QACL,CAAC;QAED,qDAAqD;QACrD,MAAM,OAAO,GAAG,IAAI,OAAO,CAAI,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,EAAE;YACrD,MAAM,cAAc,GAAG;gBACnB,OAAO,EAAE,KAAK;gBACd,YAAY,EAAE,GAAG,EAAE;oBACf,kCAAkC;gBACtC,CAAC;aACJ,CAAC;YACF,IAAI,OAAkD,CAAC;YACvD,IAAI,cAAc,KAAK,KAAK,EAAE,CAAC;gBAC3B,OAAO,GAAG,UAAU,CAAC,GAAG,EAAE;oBACtB,cAAc,CAAC,OAAO,GAAG,IAAI,CAAC;oBAC9B,+CAA+C;oBAC/C,SAAS,EAAE,EAAE,CAAC;oBAEd,uDAAuD;oBACvD,IAAI,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,YAAY,OAAO,EAAE,CAAC;wBAC1D,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;oBACpC,CAAC;oBACD,MAAM,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;gBACtC,CAAC,EAAE,cAAc,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;gBAC5C,cAAc,CAAC,YAAY,GAAG,GAAG,EAAE;oBAC/B,YAAY,CAAC,OAAO,CAAC,CAAC;gBAC1B,CAAC,CAAC;YACN,CAAC;YACD,kFAAkF;YAClF,4CAA4C;YAC5C,IAAI,CAAC;gBACD,MAAM,QAAQ,CAAC,OAAO,EAAE,MAAM,EAAE,cAAc,CAAC,CAAC;YACpD,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;gBACT,uDAAuD;gBACvD,IAAI,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,YAAY,OAAO,EAAE,CAAC;oBAC1D,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;gBACpC,CAAC;gBACD,MAAM,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;YACpC,CAAC;QACL,CAAC,CAAC,CAAC;QACH,IAAI,QAAQ,EAAE,CAAC;YACX,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC;QACvC,CAAC;QACD,OAAO,OAAO,CAAC;IACnB,CAAC;IAED;;;OAGG;IACH,UAAU,CAAC,GAAW,EAAE,KAAe;QACnC,IAAI,KAAK,EAAE,CAAC;YACR,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;iBACtB,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;iBAC9B,OAAO,CAAC,CAAC,CAAC,EAAE;gBACT,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAC7B,CAAC,CAAC,CAAC;QACX,CAAC;aAAM,CAAC;YACJ,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;QAC/B,CAAC;IACL,CAAC;IAED;;;;OAIG;IACH,SAAS,CAAC,OAA2B;QACjC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;oBACjD,IAAI,CAAC,MAAM,GAAG,GAAG,IAAI,EAAE,CAAC;oBAExB,gCAAgC;oBAChC,oDAAoD;oBACpD,IAAI;oBACJ,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBACzB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,QAAQ,CAAC,EAAU;QACf,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,EAAE,IAAI,EAAE,KAAK,IAAI,CAAC,WAAW,EAAE,CAAC;oBAChC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;oBACxD,OAAO;gBACX,CAAC;gBACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,EAAE;oBAC7C,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,KAAK,CAAC,CAAC;oBACnB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,cAAc,CAAC,EAAU;QACrB,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,EAAE;oBACnD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,KAAK,CAAC,CAAC;oBACnB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,cAAc,CAAC,EAAU,EAAE,MAAc;QACrC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,CAAC,EAAE;oBAClD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,QAAQ,CACJ,EAAU,EACV,GAAkE,EAClE,GAAa;QAEb,IAAI,OAAO,GAAG,KAAK,SAAS,EAAE,CAAC;YAC3B,GAAG,GAAG,EAAE,GAAG,EAAE,GAA0B,EAAE,GAAG,EAAE,CAAC;QACnD,CAAC;QAED,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,sDAAsD;gBACtD,IAAI,EAAE,IAAI,EAAE,KAAK,IAAI,CAAC,WAAW,EAAE,CAAC;oBAChC,IAAI,KAAqB,CAAC;oBAE1B,IAAI,OAAO,GAAG,KAAK,SAAS,EAAE,CAAC;wBAC3B,KAAK,GAAG,GAAqB,CAAC;oBAClC,CAAC;yBAAM,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAK,GAAsB,CAAC,GAAG,KAAK,SAAS,EAAE,CAAC;wBAC9E,KAAK,GAAG,GAAqB,CAAC;oBAClC,CAAC;yBAAM,CAAC;wBACJ,KAAK,GAAG;4BACJ,GAAG,EAAE,GAA0B;4BAC/B,GAAG,EAAE,KAAK;4BACV,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE;4BACd,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE;4BACd,IAAI,EAAE,sBAAsB;yBAC/B,CAAC;oBACN,CAAC;oBAED,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC;oBAE3B,mCAAmC;oBACnC,IAAI,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAE,CAAC;wBAC5B,KAAK,MAAM,EAAE,IAAI,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC;4BAC7C,IAAI,CAAC;gCACD,MAAM,YAAY,GAAG,EAAE,CAAC,EAAE,EAAE,KAAY,CAAC,CAAC;gCAC1C,IAAI,YAAY,YAAY,OAAO,EAAE,CAAC;oCAClC,KAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CACxB,OAAO,CAAC,KAAK,CAAC,qCAAqC,CAAC,EAAE,CAAC,CAC1D,CAAC;gCACN,CAAC;4BACL,CAAC;4BAAC,OAAO,CAAC,EAAE,CAAC;gCACT,OAAO,CAAC,KAAK,CAAC,sCAAsC,CAAC,EAAE,CAAC,CAAC;4BAC7D,CAAC;wBACL,CAAC;oBACL,CAAC;oBACD,OAAO,EAAE,CAAC;oBACV,OAAO;gBACX,CAAC;gBACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE;oBACzC,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH;;;;;OAKG;IACH,UAAU,CAAC,MAAgB,EAAE,qBAA+B;QACxD,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;oBAC1B,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBACtB,OAAO;gBACX,CAAC;gBAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,eAAe,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;oBAChF,IAAI,CAAC,qBAAqB,EAAE,CAAC;wBACzB,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;oBACrD,CAAC;oBACD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,IAAI,CAAC,OAAO,GAAG,GAAG,IAAI,EAAE,CAAC;wBACzB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBAC1B,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,cAAc,CAAC,IAAc;QACzB,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;oBAC/C,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,GAAG,CAAC,CAAC;oBACjB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACK,UAAU,CAAC,QAAiB;QAChC,IAAI,QAAQ,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;YAC/B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;YACvB,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,MAAM,EAAE,CAAC;gBACpC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;YACrE,CAAC;YACD,uBAAuB;YACvB,MAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAChD,IAAI,GAAG,CAAC,MAAM,EAAE,CAAC;gBACb,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,GAAG,CAAC,CAAC;YAC/C,CAAC;YACD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,EAAE,CAAC,CAAC,CAAC;YAC7F,oBAAoB;YACpB,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;YACrE,sBAAsB;YACtB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,CAAC;YACrF,qBAAqB;YACrB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBAC5C,MAAM,CAAC,EAAE,EAAE,WAAW,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gBAC3C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,EAAE,WAAW,CAAC,CAAC;YACzD,CAAC,CAAC,CAAC;QACP,CAAC;aAAM,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;YACtC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;YACxB,uBAAuB;YACvB,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,MAAM,EAAE,CAAC;gBACpC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;YACvE,CAAC;YACD,MAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAChD,IAAI,GAAG,CAAC,MAAM,EAAE,CAAC;gBACb,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,EAAE,GAAG,CAAC,CAAC;YACjD,CAAC;YACD,oBAAoB;YACpB,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;YAEtE,sBAAsB;YACtB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,CAAC;YACvF,qBAAqB;YACrB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBAC5C,MAAM,CAAC,EAAE,EAAE,WAAW,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gBAC3C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,EAAE,EAAE,WAAW,CAAC,CAAC;YAC3D,CAAC,CAAC,CAAC;QACP,CAAC;IACL,CAAC;IAED;;;;OAIG;IACH,UAAU,CAAC,SAAkB;QACzB,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,SAAS,EAAE,GAAG,CAAC,EAAE;oBAC7C,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,SAAS,CAAC,EAAU,EAAE,cAAuB,KAAK;QAC9C,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,WAAW,EAAE,EAAE,GAAG,CAAC,EAAE;oBACtD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,UAAU,CAAC,EAAU,EAAE,WAAoB;QACvC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,EAAE,EAAE,WAAW,EAAE,EAAE,GAAG,CAAC,EAAE;oBACvD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,SAAS,CAAC,EAAU,EAAE,GAA4B;QAC9C,IAAI,CAAC,GAAG,EAAE,CAAC;YACP,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC,CAAC;QACnE,CAAC;QAED,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;QACtC,OAAO,GAAG,CAAC,IAAI,CAAC;QAChB,OAAO,GAAG,CAAC,IAAI,CAAC;QAChB,OAAO,GAAG,CAAC,EAAE,CAAC;QAEd,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE;oBAC1C,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,SAAS,CAAmB,EAAK;QAC7B,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,EAAE,IAAI,EAAE,KAAK,IAAI,CAAC,WAAW,EAAE,CAAC;oBAChC,OAAO,CAAC;wBACJ,GAAG,EAAE,IAAI,CAAC,WAAW;wBACrB,IAAI,EAAE,OAAO;wBACb,MAAM,EAAE;4BACJ,IAAI,EAAE,eAAe;4BACrB,IAAI,EAAE,OAAO;yBAChB;qBACG,CAAC,CAAC;oBACV,OAAO;gBACX,CAAC;gBACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;oBAC5C,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,GAAU,CAAC,CAAC;oBACxB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,MAAM,CAAU,QAAgB,EAAE,OAAe,EAAE,IAAU;QACzD,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,OAAO,CAAC,EAAE;gBAChB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,MAAW,EAAE,EAAE;oBACjE,OAAO,CAAC,MAAM,CAAC,CAAC;gBACpB,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,YAAY,CAAC,EAAU,EAAE,GAA2B;QAChD,IAAI,CAAC,GAAG,EAAE,CAAC;YACP,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC,CAAC;QACnE,CAAC;QAED,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;QACtC,OAAO,GAAG,CAAC,IAAI,CAAC;QAChB,OAAO,GAAG,CAAC,IAAI,CAAC;QAChB,OAAO,GAAG,CAAC,EAAE,CAAC;QAEd,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE;oBAC7C,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,kBAAkB,CAAC,OAAsC;QACrD,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;YACxC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACrC,CAAC;IACL,CAAC;IAED;;;;OAIG;IACH,oBAAoB,CAAC,OAAsC;QACvD,MAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAChD,GAAG,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IACpD,CAAC;IAED;;;;OAIG;IACH,yBAAyB,CAAC,OAAqC;QAC3D,IAAI,CAAC,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;YAC/C,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC5C,CAAC;IACL,CAAC;IAED;;;;OAIG;IACH,2BAA2B,CAAC,OAAqC;QAC7D,MAAM,GAAG,GAAG,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QACvD,GAAG,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IAC3D,CAAC;IAED;;;;OAIG;IACH,wBAAwB,CAAC,OAA2C;QAChE,IAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,0BAA0B;QACtB,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC;IACxC,CAAC;IAED;;;;OAIG;IACH,wBAAwB,CAAC,OAA2C;QAChE,IAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC;IACtC,CAAC;IAED;;OAEG;IACH,0BAA0B;QACtB,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC;IACxC,CAAC;IAED;;;;OAIG;IACH,sBAAsB,CAAC,OAA+C;QAClE,IAAI,CAAC,gBAAgB,GAAG,OAAO,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,wBAAwB;QACpB,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;IACtC,CAAC;IAED;;;;;OAKG;IACH,QAAQ,CAAC,KAAc,EAAE,MAAgB;QACrC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,SAAS,KAAK,IAAI,KAAK,EAAE;YACnC,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CACb,eAAe,EACf,QAAQ,EACR,MAAM,EACN;oBACI,QAAQ,EAAE,QAAQ,KAAK,IAAI,EAAE,EAAE;oBAC/B,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,QAAQ,KAAK,SAAS,CAAC,CAAC,CAAC,aAAa;iBACzD,EACD,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;oBACT,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,MAAM,IAAI,GAAwC,EAAE,CAAC;wBACrD,IAAI,GAAG,EAAE,CAAC;4BACN,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gCACvC,IAAI,KAAK,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,QAAQ,KAAK,EAAE,EAAE,CAAC;oCAC9C,SAAS;gCACb,CAAC;gCACD,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAA4B,CAAC;4BACpE,CAAC;wBACL,CAAC;wBACD,OAAO,CAAC,IAAI,CAAC,CAAC;oBAClB,CAAC;gBACL,CAAC,CACJ,CAAC;YACN,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,aAAa,CACT,KAAyB,EACzB,GAAuB,EACvB,IAAO;QAEP,OAAO,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;IAChE,CAAC;IAED;;;;;;OAMG;IACH,KAAK,CAAC,mBAAmB,CACrB,IAAO,EACP,KAAc,EACd,GAAY;QAEZ,MAAM,GAAG,GAAG,GAAG,IAAI,IAAI,KAAK,IAAI,EAAE,IAAI,GAAG,IAAI,EAAE,EAAE,CAAC;QAClD,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;QAC1E,IAAI,IAAI,CAAC,gBAAgB,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC;YAC/B,sBAAsB;YACtB,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;QACxC,CAAC;QACD,OAAO,MAAM,CAAC;IAClB,CAAC;IAED;;;;;;OAMG;IACH,KAAK,CAAC,yBAAyB,CAC3B,IAAO,EACP,KAAc,EACd,GAAY;QAEZ,MAAM,GAAG,GAAG,GAAG,IAAI,IAAI,KAAK,IAAI,EAAE,IAAI,GAAG,IAAI,EAAE,EAAE,CAAC;QAClD,IAAI,IAAI,CAAC,gBAAgB,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC;YAC/B,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAQ,CAAC,CAAC;QAC9D,CAAC;QAED,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;QAC1E,IAAI,CAAC,gBAAgB,KAAK,EAAE,CAAC;QAC7B,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;QACpC,OAAO,MAAM,CAAC;IAClB,CAAC;IAED;;;;;;;OAOG;IACH,mBAAmB,CACf,MAAc,EACd,IAAO,EACP,KAAc,EACd,GAAY;QAEZ,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,KAAK,KAAK,EAAE,CAAC;gBACb,GAAG,KAAK,QAAQ,CAAC;gBAEjB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;oBAC5F,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,MAAM,IAAI,GAAqD,EAAE,CAAC;wBAClE,IAAI,GAAG,IAAI,GAAG,CAAC,IAAI,EAAE,CAAC;4BAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gCACvC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;4BAC7C,CAAC;wBACL,CAAC;wBACD,OAAO,CAAC,IAAI,CAAC,CAAC;oBAClB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,aAAa;QACT,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CACb,eAAe,EACf,QAAQ,EACR,MAAM,EACN,EAAE,QAAQ,EAAE,EAAE,EAAE,MAAM,EAAE,QAAQ,EAAE,EAClC,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE;oBACV,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,IAAK,CAAC,IAAI,EAAE,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAA0B,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;oBAC9F,CAAC;gBACL,CAAC,CACJ,CAAC;YACN,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,OAAO,CAAC,SAAwB,EAAE,IAAY;QAC1C,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,EAAE;oBACzD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,KAAM,CAAC,CAAC;oBACpB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,QAAQ,CACJ,SAAwB,EACxB,QAAgB,EAChB,MAAgB;QAEhB,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,UAAU,EAAE,SAAS,EAAE,QAAQ,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE;oBAC3F,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,EAAE,IAAI,EAAE,IAAc,EAAE,QAAQ,EAAE,IAAK,EAAE,CAAC,CAAC;oBACvD,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,WAAW,CAAC,SAAiB,EAAE,QAAgB,EAAE,IAA0B;QACvE,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE,CAAC;oBAC3B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,CAAC,EAAE;wBAC5D,IAAI,GAAG,EAAE,CAAC;4BACN,MAAM,CAAC,GAAG,CAAC,CAAC;wBAChB,CAAC;6BAAM,CAAC;4BACJ,OAAO,EAAE,CAAC;wBACd,CAAC;oBACL,CAAC,CAAC,CAAC;gBACP,CAAC;qBAAM,CAAC;oBACJ,MAAM,MAAM,GAAG,IAAI,CACf,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC,IAAI,GAAG,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CACpF,CAAC;oBAEF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,CAAC,EAAE;wBAChE,IAAI,GAAG,EAAE,CAAC;4BACN,MAAM,CAAC,GAAG,CAAC,CAAC;wBAChB,CAAC;6BAAM,CAAC;4BACJ,OAAO,EAAE,CAAC;wBACd,CAAC;oBACL,CAAC,CAAC,CAAC;gBACP,CAAC;YACL,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,UAAU,CAAC,SAAiB,EAAE,QAAgB;QAC1C,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,CAAC,EAAE;oBACvD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,YAAY,CAAC,SAAiB,EAAE,UAAkB;QAC9C,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,CAAC,EAAE;oBAC3D,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,MAAM,CAAC,SAAiB,EAAE,OAAe,EAAE,OAAe;QACtD,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,EAAE;oBAC3D,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,UAAU,CAAC,SAAiB,EAAE,OAAe,EAAE,OAAe;QAC1D,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,EAAE;oBAC/D,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,OAAO;IACH,gBAAgB;IAChB,IAAY;IACZ,yBAAyB;IACzB,GAAW;IACX,iBAAiB;IACjB,KAAa;IACb,+BAA+B;IAC/B,UAAmB;QAEnB,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,cAAc,EAAE,UAAU;YAC1B,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE;gBACnC,IAAI,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC;gBAE7B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE;oBACjD,IAAI,OAAO,CAAC,OAAO,EAAE,CAAC;wBAClB,OAAO;oBACX,CAAC;oBACD,OAAO,CAAC,YAAY,EAAE,CAAC;oBAEvB,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,EAAE,CAAC;oBACd,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,eAAe,CAAC,MAAgB;QAC5B,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,cAAc;YACxB,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,KAAK,EAAC,OAAO,EAAC,EAAE;gBACtB,IAAI,YAAY,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;gBACxD,YAAoB,KAAK,EAAE,CAAC;gBAC5B,YAAoB,CAAC,MAAM,KAAK,EAAE,CAAC;gBACnC,YAAoB,CAAC,MAAM,KAAK,EAAE,CAAC;gBAEpC,OAAO,CAAC,YAAa,CAAC,CAAC;YAC3B,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED,gFAAgF;IAChF,sBAAsB,CAAC,MAAgB;QACnC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,oBAAoB;YAC9B,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,YAAY,EAAE,IAAI;YAClB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,wBAAwB,EAAE,CAAC,GAAG,EAAE,YAAY,EAAE,EAAE;oBAC9D,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACH,YAAoB,KAAK,EAAE,CAAC;wBAC5B,YAAoB,CAAC,MAAM,KAAK,EAAE,CAAC;wBACnC,YAAoB,CAAC,MAAM,KAAK,EAAE,CAAC;wBACpC,OAAO,CAAC,YAAa,CAAC,CAAC;oBAC3B,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,gBAAgB,CAAC,OAAkC;QAC/C,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,OAAO,IAAI,GAAG,EAAE,CAAC,GAAG,EAAE,MAAM,EAAE,EAAE;oBAClE,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,MAAM,IAAI,EAAE,CAAC,CAAC;oBAC1B,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,iBAAiB,CACb,OAAkC,EAClC,IAAO;QAEP,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,EAAE,OAAO,IAAI,GAAG,EAAE,IAAI,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,EAAE;oBAC1E,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,OAAc,CAAC,CAAC;oBAC5B,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,eAAe,CAAC,GAAgC;QAC5C,OAAO,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE,GAAG,CAAC,CAAC;IAChD,CAAC;IAED;;OAEG;IACH,YAAY;QACR,OAAO,IAAI,CAAC,OAAO,CAAC;IACxB,CAAC;IAED;;;;;OAKG;IACH,UAAU,CAAC,EAAU,EAAE,OAAmC;QACtD,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,GAAG,EAAE,MAAM,EAAE,EAAE;oBACzD,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,MAAO,CAAC,CAAC;oBACrB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,YAAY,CACR,EAAU,EACV,OAAmC;QAMnC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,EAAE;oBAC1E,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC;4BACJ,MAAM,EAAE,MAAO;4BACf,SAAS,EAAE,SAAU;4BACrB,IAAI,EAAE,IAAK;yBACd,CAAC,CAAC;oBACP,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,cAAc,CAAC,IAAY,EAAE,MAAgB;QACzC,IAAI,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC;QAC7B,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,OAAO,IAAI,EAAE;YACvB,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,KAAK,EAAC,OAAO,EAAC,EAAE;gBACtB,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;gBACvC,OAAO,CAAC,GAAG,EAAE,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC;YACvC,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,UAAU,CAAC,MAAgB;QACvB,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,SAAS;YACnB,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,UAAU,EAAE,EAAE;oBACzD,uCAAuC;oBACvC,IAAI,GAAG,IAAI,CAAC,OAAO,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,CAAC,KAAK,CAAC,eAAe,CAAC,EAAE,CAAC;wBAC3E,OAAO,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;oBACtD,CAAC;yBAAM,CAAC;wBACJ,IAAI,GAAG,EAAE,CAAC;4BACN,MAAM,CAAC,GAAG,CAAC,CAAC;wBAChB,CAAC;6BAAM,CAAC;4BACJ,OAAO,CAAC;gCACJ,OAAO,EAAE,OAAQ;gCACjB,UAAU,EAAE,UAAW;6BAC1B,CAAC,CAAC;wBACP,CAAC;oBACL,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,gBAAgB;QACZ,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,SAAS;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE;oBAC9C,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,IAAK,CAAC,CAAC;oBACnB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,UAAU,CAAC,OAAe,EAAE,QAAgB;QACxC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC,GAAG,EAAE,MAAM,EAAE,EAAE;oBAC/D,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;oBACtB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,cAAc;QACV,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,OAAO,CAAC,EAAE;gBAChB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE;oBACjD,OAAO,CAAC,IAAI,CAAC,CAAC;gBAClB,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,OAAO;QACH,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,MAAM;YAChB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,KAAK,EAAC,OAAO,EAAC,EAAE;gBACtB,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;gBACrD,OAAO,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;YAC/B,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,qBAAqB,CAAC,OAAe,EAAE,MAAgB;QACnD,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,qBAAqB,OAAO,EAAE;YACxC,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,uBAAuB,EAAE,OAAO,EAAE,CAAC,GAAG,EAAE,QAAQ,EAAE,EAAE;oBAClE,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,QAAQ,CAAC,CAAC;oBACtB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH;;;;;OAKG;IACH,mBAAmB,CAAC,OAA0B,EAAE,MAAgB;QAC5D,IAAI,OAAO,OAAO,KAAK,SAAS,EAAE,CAAC;YAC/B,MAAM,GAAG,OAAO,CAAC;YACjB,OAAO,GAAG,EAAE,CAAC;QACjB,CAAC;QACD,OAAO,KAAK,EAAE,CAAC;QAEf,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,aAAa,OAAO,EAAE;YAChC,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,KAAK,EAAC,OAAO,EAAC,EAAE;gBACtB,MAAM,QAAQ,GAAG,OAAO,CAAC,CAAC,CAAC,kBAAkB,OAAO,GAAG,CAAC,CAAC,CAAC,iBAAiB,CAAC;gBAC5E,MAAM,MAAM,GAAG,GAAG,QAAQ,QAAQ,CAAC;gBAEnC,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,UAAU,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;gBAC/E,MAAM,eAAe,GAAG,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;gBACjD,IAAI,OAAO,EAAE,CAAC;oBACV,OAAO,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,KAAK,OAAO,CAAC,CAAC,CAAC;gBACpE,CAAC;qBAAM,CAAC;oBACJ,OAAO,CAAC,eAAe,CAAC,CAAC;gBAC7B,CAAC;YACL,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,WAAW,CAAC,OAAgB,EAAE,MAAgB;QAC1C,IAAI,OAAO,OAAO,KAAK,SAAS,EAAE,CAAC;YAC/B,MAAM,GAAG,OAAO,CAAC;YACjB,OAAO,GAAG,EAAE,CAAC;QACjB,CAAC;QACD,OAAO,KAAK,EAAE,CAAC;QAEf,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,WAAW,OAAO,EAAE;YAC9B,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,KAAK,EAAC,OAAO,EAAC,EAAE;gBACtB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAC3C,SAAS,EACT,kBAAkB,OAAO,IAAI,EAAE,EAAE,EACjC,kBAAkB,OAAO,IAAI,QAAQ,EAAE,CAC1C,CAAC;gBACF,MAAM,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;gBAC/C,IAAI,OAAO,EAAE,CAAC;oBACV,OAAO,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,KAAK,OAAO,CAAC,CAAC,CAAC;gBACnE,CAAC;qBAAM,CAAC;oBACJ,OAAO,CAAC,cAAc,CAAC,CAAC;gBAC5B,CAAC;YACL,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,SAAS,CAAC,MAAgB;QACtB,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,QAAQ,EAAE,QAAQ;YAClB,WAAW,EAAE,MAAM;YACnB,sCAAsC;YACtC,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CACb,eAAe,EACf,QAAQ,EACR,OAAO,EACP;oBACI,QAAQ,EAAE,eAAe;oBACzB,MAAM,EAAE,qBAAqB;iBAChC,EACD,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;oBACT,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,CAAC;wBACJ,OAAO,CAAC,0BAA0B,CAAuB,GAAG,CAAC,CAAC,CAAC;oBACnE,CAAC;gBACL,CAAC,CACJ,CAAC;YACN,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,MAAM;QACF,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;oBAC9B,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBACtC,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;;OAOG;IACH,mBAAmB,CACf,cAAsB,EACtB,WAAmB,EACnB,IAAS,EACT,QAAiC;QAMjC,OAAO,IAAI,CAAC,OAAO,CAAC;YAChB,cAAc,EAAE,KAAK;YACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,EAAE,cAAc,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,GAAG,EAAE,eAAe,EAAE,EAAE;oBAC7F,IAAI,GAAG,EAAE,CAAC;wBACN,MAAM,CAAC,GAAG,CAAC,CAAC;oBAChB,CAAC;yBAAM,IAAI,eAAe,EAAE,CAAC;wBACzB,IAAI,eAAe,CAAC,KAAK,EAAE,CAAC;4BACxB,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;wBAClC,CAAC;6BAAM,CAAC;4BACJ,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,iBAAiB,CAAC,EAAE,CAAC;gCAChD,cAAc,GAAG,kBAAkB,cAAc,EAAE,CAAC;4BACxD,CAAC;4BACD,gBAAgB;4BAChB,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC;gCACvC,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;4BAEtD,IACI,CAAC,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC,IAAI,CAC7C,YAAY,CAAC,EAAE,CACX,YAAY,CAAC,WAAW,KAAK,WAAW,IAAI,YAAY,CAAC,QAAQ,KAAK,QAAQ,CACrF,EACH,CAAC;gCACC,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC;oCAC7C,WAAW;oCACX,QAAQ;iCACX,CAAC,CAAC;4BACP,CAAC;4BACD,OAAO,CAAC,eAAe,CAAC,CAAC;wBAC7B,CAAC;oBACL,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;SACJ,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACH,uBAAuB,CACnB,cAAsB,EACtB,WAAmB,EACnB,QAAiC;QAEjC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,iBAAiB,CAAC,EAAE,CAAC;YAChD,cAAc,GAAG,kBAAkB,cAAc,EAAE,CAAC;QACxD,CAAC;QAED,IAAI,OAAO,CAAC;QACZ,MAAM,cAAc,GAAG,EAAE,CAAC;QAC1B,GAAG,CAAC;YACA,OAAO,GAAG,KAAK,CAAC;YAChB,MAAM,KAAK,GAAG,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,EAAE,SAAS,CAChE,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,IAAI,GAAG,CAAC,WAAW,KAAK,WAAW,CAAC,IAAI,CAAC,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,KAAK,QAAQ,CAAC,CACvG,CAAC;YAEF,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE,CAAC;gBACxD,OAAO,GAAG,IAAI,CAAC;gBACf,uBAAuB;gBACvB,MAAM,YAAY,GAAG,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC,KAAK,CAAC,CAAC,WAAW,CAAC;gBAEpF,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC7D,IAAI,CAAC,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC,MAAM,EAAE,CAAC;oBACtD,OAAO,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC;gBACvD,CAAC;gBAED,qEAAqE;gBACrE,MAAM,KAAK,GACP,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC;oBAC3C,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,WAAW,KAAK,YAAY,CAAC,CAAC;gBAE9F,IAAI,CAAC,KAAK,EAAE,CAAC;oBACT,cAAc,CAAC,IAAI,CACf,IAAI,CAAC,OAAO,CAAC;wBACT,cAAc,EAAE,KAAK;wBACrB,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;4BAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CACb,mBAAmB,EACnB,cAAc,EACd,WAAW,EACX,CAAC,GAAG,EAAE,aAAa,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CACvE,CAAC;wBACN,CAAC;qBACJ,CAAC,CACL,CAAC;gBACN,CAAC;YACL,CAAC;QACL,CAAC,QAAQ,OAAO,IAAI,CAAC,CAAC,QAAQ,IAAI,CAAC,WAAW,CAAC,EAAE;QAEjD,IAAI,cAAc,CAAC,MAAM,EAAE,CAAC;YACxB,OAAO,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;QACzF,CAAC;QAED,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAClC,CAAC;IAED;;;;;OAKG;IACH,GAAG,CAAC,IAAY,EAAE,KAAc;QAC5B,OAAO,IAAI;YACP,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC;gBACT,cAAc,EAAE,KAAK;gBACrB,QAAQ,EAAE,OAAO,CAAC,EAAE;oBAChB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;oBACtC,OAAO,OAAO,CAAC,IAAI,CAAC,CAAC;gBACzB,CAAC;aACJ,CAAC;YACJ,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAED;;;;;OAKG;IACH,gBAAgB,CAAC,EAAU;QACvB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;IAC1B,CAAC;CACJ","sourcesContent":["import type { ConnectionProps, LogMessage } from './ConnectionProps.js';\nimport { createDeferredPromise } from './DeferredPromise.js';\nimport type { EmitEventHandler, ListenEventHandler, SocketClient } from './SocketClient.js';\nimport { getObjectViewResultToArray, normalizeHostId, pattern2RegEx, wait } from './tools.js';\n\nif (typeof (globalThis as any).process !== 'undefined') {\n    // Implement location, localStorage and sessionStorage for Node.js environment\n    // @ts-expect-error globalThis.location is not defined in Node.js\n    globalThis.location ||= {\n        href: 'http://localhost:8081/',\n        protocol: 'http:',\n        host: 'localhost:8081',\n        pathname: '/',\n        hostname: 'localhost',\n        reload: () => {},\n    };\n    // @ts-expect-error globalThis.location is not defined in Node.js\n    globalThis.localStorage ||= {\n        _keys: {} as { [key: string]: string },\n        setItem: (key: string, value: string) => {\n            globalThis.localStorage._keys[key] = value;\n        },\n        getItem: (key: string): string | null => {\n            if (key in globalThis.localStorage._keys) {\n                return globalThis.localStorage._keys[key];\n            }\n            return null;\n        },\n        removeItem: (key: string) => {\n            if (key in globalThis.localStorage._keys) {\n                delete globalThis.localStorage._keys[key];\n            }\n        },\n    };\n    globalThis.sessionStorage ||= globalThis.localStorage;\n    globalThis.navigator ||= {\n        language: 'en',\n    } as Navigator;\n}\n\nexport interface OAuth2Response {\n    /** The access token */\n    access_token: string;\n    /** The time in seconds when the access token expires, e.g., 3600 for 1 hour */\n    expires_in: number;\n    /** The type of the token */\n    token_type: 'Bearer' | 'JWT';\n    /** The refresh token */\n    refresh_token: string;\n    /** The time in seconds when the refresh token expires, e.g., 600 for 10 minutes */\n    refresh_token_expires_in: number;\n}\n\nexport interface StoredTokens {\n    refresh_token: string;\n    access_token: string;\n    expires_in: Date;\n    refresh_token_expires_in: Date;\n    stayLoggedIn: boolean;\n    owner: string | undefined;\n}\n\nexport interface SocketACL {\n    user: `system.user.${string}` | '';\n    groups: `system.group.${string}`[];\n    object?: {\n        read: boolean;\n        list: boolean;\n        write: boolean;\n        delete: boolean;\n    };\n    state?: {\n        list: boolean;\n        read: boolean;\n        write: boolean;\n        delete: boolean;\n        create: boolean;\n    };\n    users?: {\n        create: boolean;\n        delete: boolean;\n        write: boolean;\n    };\n    other?: {\n        http: boolean;\n        execute: boolean;\n        sendto: boolean;\n    };\n    file?: {\n        list: boolean;\n        create: boolean;\n        write: boolean;\n        read: boolean;\n        delete: boolean;\n    };\n}\n\n/** Possible progress states. */\nexport enum PROGRESS {\n    /** The socket is connecting. */\n    CONNECTING = 0,\n    /** The socket is successfully connected. */\n    CONNECTED = 1,\n    /** All objects are loaded. */\n    OBJECTS_LOADED = 2,\n    /** The socket is ready for use. */\n    READY = 3,\n}\n\nexport enum ERRORS {\n    PERMISSION_ERROR = 'permissionError',\n    NOT_CONNECTED = 'notConnectedError',\n    TIMEOUT = 'timeout',\n    NOT_ADMIN = 'Allowed only in admin',\n    NOT_SUPPORTED = 'Not supported',\n}\n\n/** @deprecated Use {@link ERRORS.PERMISSION_ERROR} instead */\nexport const PERMISSION_ERROR = ERRORS.PERMISSION_ERROR;\n/** @deprecated Use {@link ERRORS.NOT_CONNECTED} instead */\nexport const NOT_CONNECTED = ERRORS.NOT_CONNECTED;\n\n// Options to use for the backend request wrapper\n/**\n * @internal\n */\nexport interface RequestOptions<T> {\n    /** The key that is used to cache the results for later requests of the same kind */\n    cacheKey?: string;\n    /** Used to bypass the cache */\n    forceUpdate?: boolean;\n    /** Can be used to identify the request method in error messages */\n    requestName?: string;\n    /**\n     * The timeout in milliseconds after which the call will reject with a timeout error.\n     * If no timeout is given, the default is used. Set this to `false` to explicitly disable the timeout.\n     */\n    commandTimeout?: number | false;\n    /** Will be called when the timeout elapses */\n    onTimeout?: () => void;\n    /** Whether the call should only be allowed in the admin adapter */\n    requireAdmin?: boolean;\n    /** Require certain features to be supported for this call */\n    requireFeatures?: string[];\n    /** The function that does the actual work */\n    executor: (\n        resolve: (value: T | PromiseLike<T> | Promise<T>) => void,\n        reject: (reason?: any) => void,\n        /** Can be used to check in the executor whether the request has timed out and/or stop it from timing out */\n        timeout: Readonly<{ elapsed: boolean; clearTimeout: () => void }>,\n    ) => void | Promise<void>;\n}\n\nexport type BinaryStateChangeHandler = (id: string, base64: string | null) => void;\n\nexport type FileChangeHandler = (\n    id: string,\n    fileName: string,\n    size: number | null, // null if deleted\n) => void;\n\nexport interface OldObject {\n    _id: string;\n    type: string;\n}\n\nexport type ObjectChangeHandler = (\n    id: string,\n    obj: ioBroker.Object | null | undefined,\n    oldObj?: OldObject,\n) => void | Promise<void>;\n\nexport type InstanceMessageCallback = (data: any, sourceInstance: string, messageType: string) => void | Promise<void>;\n\nexport type InstanceSubscribe = {\n    messageType: string;\n    callback: InstanceMessageCallback;\n};\n\nconst ADAPTERS = ['material', 'echarts', 'vis'];\n\nexport class Connection<\n    CustomListenEvents extends Record<keyof CustomListenEvents, ListenEventHandler> = Record<string, never>,\n    CustomEmitEvents extends Record<keyof CustomEmitEvents, EmitEventHandler> = Record<string, never>,\n> {\n    private readonly props: ConnectionProps;\n    public readonly connId: string;\n    private lastAccessToken: string | null = null;\n\n    private ignoreState: string = '';\n    private connected: boolean = false;\n    private subscribed: boolean = false;\n    private firstConnect: boolean = true;\n    public waitForRestart: boolean = false;\n    public loaded: boolean = false;\n    private simStates: Record<string, ioBroker.State> = {};\n    private objectViewCached:\n        | { [key: string]: Record<string, ioBroker.AnyObject & { type: ioBroker.ObjectType }> }\n        | undefined;\n\n    /**\n     * Creates a new instance of the Connection class.\n     *\n     * @param props The connection properties.\n     */\n\n    constructor(props: Partial<ConnectionProps>) {\n        this.props = this.applyDefaultProps(props);\n\n        // Create unique ID of this instance\n        this.connId = `${this.props.name ? `${this.props.name}-` : ''}${Math.round(Math.random() * 1000000)\n            .toString()\n            .padStart(6, '0')}`;\n\n        this.waitForSocketLib()\n            .then(() => this.startSocket())\n            .catch(e => {\n                alert(`Socket connection could not be initialized: ${e}`);\n            });\n    }\n\n    private applyDefaultProps(props: Partial<ConnectionProps>): ConnectionProps {\n        return {\n            ...props,\n            // Define default props that always need to be set\n            protocol: props.protocol || globalThis.location.protocol,\n            host: props.host || globalThis.location.hostname,\n            port: props.port || (globalThis.location.port === '3000' ? 8081 : globalThis.location.port),\n            ioTimeout: Math.max(props.ioTimeout || 20000, 20000),\n            cmdTimeout: Math.max(props.cmdTimeout || 5000, 5000),\n            admin5only: props.admin5only || false,\n            autoSubscribes: props.autoSubscribes ?? [],\n            autoSubscribeLog: props.autoSubscribeLog ?? false,\n            doNotLoadACL: props.doNotLoadACL ?? true,\n            doNotLoadAllObjects: props.doNotLoadAllObjects ?? true,\n        };\n    }\n\n    private readonly statesSubscribes: Record<\n        string,\n        {\n            reg: RegExp;\n            cbs: (ioBroker.StateChangeHandler | BinaryStateChangeHandler)[];\n        }\n    > = {};\n    private readonly filesSubscribes: Record<\n        string,\n        {\n            regId: RegExp;\n            regFilePattern: RegExp;\n            cbs: FileChangeHandler[];\n        }\n    > = {};\n    private readonly objectsSubscribes: Record<string, { reg: RegExp; cbs: ObjectChangeHandler[] }> = {};\n    private objects: Record<string, ioBroker.Object> = {};\n    private states: Record<string, ioBroker.State> = {};\n\n    public acl: SocketACL | null = null;\n    public isSecure: boolean = false;\n    // Do not inform about readiness two times\n    public onReadyDone: boolean = false;\n\n    private readonly onConnectionHandlers: ((connected: boolean) => void)[] = [];\n    private readonly onLogHandlers: ((message: LogMessage) => void)[] = [];\n\n    private onCmdStdoutHandler?: (id: string, text: string) => void;\n    private onCmdStderrHandler?: (id: string, text: string) => void;\n    private onCmdExitHandler?: (id: string, exitCode: number) => void;\n    private onError(error: any): void {\n        (this.props.onError ?? console.error)(error);\n    }\n\n    /** The socket instance */\n    protected _socket!: SocketClient<CustomListenEvents, CustomEmitEvents>;\n\n    private _waitForSocketPromise?: Promise<void>;\n    private readonly _waitForFirstConnectionPromise = createDeferredPromise();\n\n    /** array with all subscriptions to instances */\n    private _instanceSubscriptions: Record<string, InstanceSubscribe[]> = {};\n\n    /** Cache for server requests */\n    private readonly _promises: Record<string, Promise<any>> = {};\n\n    protected _authTimer: ReturnType<typeof setTimeout> | null = null;\n    protected _refreshTimer: ReturnType<typeof setTimeout> | null = null;\n\n    protected _systemConfig?: ioBroker.SystemConfigObject;\n    /** The \"system.config\" object */\n    public get systemConfig(): Readonly<ioBroker.SystemConfigObject> | undefined {\n        return this._systemConfig;\n    }\n\n    /** System language. It could be changed during runtime */\n    public systemLang: ioBroker.Languages = 'en';\n\n    /**\n     * Checks if this connection is running in a web adapter and not in an admin.\n     *\n     * @returns True if running in a web adapter or in a socketio adapter.\n     */\n    static isWeb(): boolean {\n        return (globalThis as any).socketUrl !== undefined;\n    }\n\n    private waitForSocketLib(): Promise<void> {\n        // Only wait once\n        if (this._waitForSocketPromise) {\n            return this._waitForSocketPromise;\n        }\n\n        // eslint-disable-next-line no-async-promise-executor\n        this._waitForSocketPromise = new Promise(async (resolve, reject) => {\n            // Connect function was provided, so we do not need to wait for the socket.io library\n            if (this.props.connect) {\n                resolve();\n                return;\n            }\n\n            // If socket io is not yet loaded, we need to wait for it\n            if (typeof (globalThis as any).io === 'undefined' && typeof (globalThis as any).iob === 'undefined') {\n                // If the registerSocketOnLoad function is defined in index.html,\n                // we can use it to know when the socket library was loaded\n                if (typeof (globalThis as any).registerSocketOnLoad === 'function') {\n                    (globalThis as any).registerSocketOnLoad(() => resolve());\n                } else {\n                    // otherwise, we need to poll\n                    for (let i = 1; i <= 30; i++) {\n                        if ((globalThis as any).io || (globalThis as any).iob) {\n                            return resolve();\n                        }\n                        await wait(100);\n                    }\n\n                    reject(new Error('Socket library could not be loaded!'));\n                }\n            } else {\n                resolve();\n            }\n        });\n        return this._waitForSocketPromise;\n    }\n\n    /**\n     * Starts the socket.io connection.\n     */\n    async startSocket(): Promise<void> {\n        if (this._socket) {\n            return;\n        }\n\n        let host = this.props.host;\n        let port = this.props.port;\n        let protocol = (this.props.protocol || globalThis.location.protocol).replace(':', '');\n        let path = globalThis.location.pathname;\n\n        if (globalThis.location.hostname === 'iobroker.net' || globalThis.location.hostname === 'iobroker.pro') {\n            path = '';\n        } else {\n            // if web adapter, socket io could be on another port or even host\n            if ((globalThis as any).socketUrl) {\n                const parsed = new globalThis.URL((globalThis as any).socketUrl);\n                host = parsed.hostname;\n                port = parsed.port;\n                protocol = parsed.protocol.replace(':', '');\n            }\n            // get a current path\n            const pos = path.lastIndexOf('/');\n            if (pos !== -1) {\n                path = path.substring(0, pos + 1);\n            }\n\n            if (Connection.isWeb()) {\n                // remove one level, like echarts, vis, .... We have here: '/echarts/'\n                const parts = path.split('/');\n                if (parts.length > 2) {\n                    parts.pop();\n                    parts.pop();\n                    // material can have paths like this '/material/1.3.0/', so remove one more level\n                    if (ADAPTERS.includes(parts[parts.length - 1])) {\n                        parts.pop();\n                    }\n                    path = parts.join('/');\n                    if (!path.endsWith('/')) {\n                        path += '/';\n                    }\n                }\n            }\n        }\n\n        const url = port ? `${protocol}://${host}:${port}` : `${protocol}://${host}`;\n\n        const connectFunc: (name: string, par: any) => SocketClient =\n            this.props.connect || ((globalThis as any).io || (globalThis as any).iob).connect;\n\n        this._socket = connectFunc(url, {\n            path: path.endsWith('/') ? `${path}socket.io` : `${path}/socket.io`,\n            query: 'ws=true',\n            name: this.props.name,\n            timeout: this.props.ioTimeout,\n            uuid: this.props.uuid,\n            token: this.props.token,\n        });\n\n        this._socket.on('connect', noTimeout => {\n            // Listen for messages from other tabs\n            globalThis.addEventListener?.('storage', this.onAccessTokenUpdated);\n\n            const tokens = Connection.readTokens();\n            if (tokens && !tokens.owner) {\n                // Take the ownership of the token\n                const now = Date.now();\n                this.saveTokens(\n                    {\n                        access_token: tokens.access_token,\n                        refresh_token: tokens.refresh_token,\n                        expires_in: Math.round((tokens.expires_in.getTime() - now) / 1000),\n                        refresh_token_expires_in: Math.round((tokens.refresh_token_expires_in.getTime() - now) / 1000),\n                        token_type: 'Bearer',\n                    },\n                    tokens.stayLoggedIn,\n                );\n            }\n\n            this.onReadyDone = false;\n            // If the user is not admin, it takes some time to install the handlers, because all rights must be checked\n            if (noTimeout !== true) {\n                this.connected = true;\n                setTimeout(\n                    () =>\n                        this.getVersion()\n                            .then(info => {\n                                const [major, minor, patch] = info.version.split('.');\n                                const v = parseInt(major, 10) * 10000 + parseInt(minor, 10) * 100 + parseInt(patch, 10);\n                                if (v < 40102) {\n                                    this._authTimer = null;\n                                    // possible this is an old version of admin\n                                    this.onPreConnect(false, false);\n                                } else {\n                                    this._socket.emit('authenticate', (isOk, isSecure) =>\n                                        this.onPreConnect(isOk, isSecure),\n                                    );\n                                }\n                            })\n                            .catch(e =>\n                                this.onError({\n                                    message: e.toString(),\n                                    operation: 'getVersion',\n                                }),\n                            ),\n                    500,\n                );\n            } else {\n                // iobroker websocket waits, till all handlers are installed\n                this._socket.emit('authenticate', (isOk, isSecure) => {\n                    this.onPreConnect(isOk, isSecure);\n                });\n            }\n        });\n\n        this._socket.on('reconnect', () => {\n            this.onReadyDone = false;\n            this.props.onProgress?.(PROGRESS.READY);\n            this.connected = true;\n\n            if (this.waitForRestart) {\n                globalThis.location.reload();\n            } else {\n                this._subscribe(true);\n                this.onConnectionHandlers.forEach(cb => cb(true));\n            }\n        });\n\n        this._socket.on('disconnect', () => {\n            this.onReadyDone = false;\n            this.connected = false;\n            this.subscribed = false;\n            this.props.onProgress?.(PROGRESS.CONNECTING);\n            this.onConnectionHandlers.forEach(cb => cb(false));\n        });\n\n        this._socket.on('reauthenticate', () => this.authenticate());\n\n        this._socket.on('log', (message: LogMessage) => {\n            this.props.onLog?.(message);\n            this.onLogHandlers.forEach(cb => cb(message));\n        });\n\n        this._socket.on('error', (err: any) => {\n            let _err: string;\n\n            if (err == undefined) {\n                _err = '';\n            } else if (typeof err.toString === 'function') {\n                _err = err.toString();\n            } else {\n                _err = JSON.stringify(err);\n                console.error(`Received strange error: ${_err}`);\n            }\n\n            if (_err.includes('User not authorized')) {\n                this.authenticate();\n            } else if (_err.includes('websocket error')) {\n                console.error(`Socket Error => reload: ${err}`);\n                globalThis.location.reload();\n            } else {\n                console.error(`Socket Error: ${err}`);\n            }\n        });\n\n        this._socket.on('connect_error', (err: any) => console.error(`Connect error: ${err}`));\n\n        this._socket.on('permissionError', err =>\n            this.onError({\n                message: 'no permission',\n                operation: err.operation,\n                type: err.type,\n                id: err.id || '',\n            }),\n        );\n\n        this._socket.on('objectChange', (id, obj) => {\n            setTimeout(() => this.objectChange(id, obj), 0);\n        });\n\n        this._socket.on('stateChange', (id, state) => {\n            setTimeout(() => this.stateChange(id, state), 0);\n        });\n\n        // instance message\n        this._socket.on('im', (messageType, from, data) => {\n            setTimeout(() => this.instanceMessage(messageType, from, data), 0);\n        });\n\n        this._socket.on('fileChange', (id, fileName, size) => {\n            setTimeout(() => this.fileChange(id, fileName, size), 0);\n        });\n\n        this._socket.on('cmdStdout', (id, text) => {\n            this.onCmdStdoutHandler?.(id, text);\n        });\n\n        this._socket.on('cmdStderr', (id, text) => {\n            this.onCmdStderrHandler?.(id, text);\n        });\n\n        this._socket.on('cmdExit', (id, exitCode) => {\n            this.onCmdExitHandler?.(id, exitCode);\n        });\n\n        return Promise.resolve();\n    }\n\n    /**\n     * Called internally.\n     */\n    private onPreConnect(_isOk: boolean, isSecure: boolean): void {\n        if (this._authTimer) {\n            clearTimeout(this._authTimer);\n            this._authTimer = null;\n        }\n\n        this.connected = true;\n        this.isSecure = isSecure;\n\n        if (this.waitForRestart) {\n            globalThis.location.reload();\n        } else {\n            if (this.firstConnect) {\n                void this.loadData().catch(e => {\n                    console.error(`Cannot load data: ${e}`);\n                });\n            } else {\n                this.props.onProgress?.(PROGRESS.READY);\n            }\n\n            this._subscribe(true);\n            this.onConnectionHandlers.forEach(cb => cb(true));\n\n            this.checkAccessTokenExpire();\n        }\n\n        this._waitForFirstConnectionPromise.resolve();\n    }\n\n    static readTokens(): StoredTokens | null {\n        let tokenString: string | null | undefined = globalThis.sessionStorage.getItem('iob_tokens');\n        const stayLoggedIn = !tokenString;\n        if (!tokenString) {\n            tokenString = globalThis.localStorage.getItem('iob_tokens');\n        }\n        if (!tokenString) {\n            return null;\n        }\n\n        const [refresh_token, refresh_token_expires_in, access_token, expires_in, owner] = tokenString.split(';');\n        const refreshExpires = new Date(refresh_token_expires_in);\n        if (refreshExpires.getTime() < Date.now()) {\n            // refresh token expired\n            return null;\n        }\n        return {\n            refresh_token,\n            refresh_token_expires_in: refreshExpires,\n            access_token,\n            expires_in: new Date(expires_in),\n            owner,\n            stayLoggedIn,\n        };\n    }\n\n    static saveTokensStatic(data: OAuth2Response, stayLoggedIn: boolean, owner?: string): void {\n        const tokenStr = `${data.refresh_token};${new Date(Date.now() + data.refresh_token_expires_in * 1000).toISOString()};${data.access_token};${new Date(Date.now() + data.expires_in * 1000).toISOString()}${owner ? `;${owner}` : ''}`;\n        if (stayLoggedIn) {\n            globalThis.localStorage.setItem('iob_tokens', tokenStr);\n        } else {\n            globalThis.sessionStorage.setItem('iob_tokens', tokenStr);\n        }\n    }\n\n    public saveTokens(data: OAuth2Response, stayLoggedIn: boolean): void {\n        Connection.saveTokensStatic(data, stayLoggedIn, this.connId);\n    }\n\n    static deleteTokensStatic(): void {\n        globalThis.localStorage.removeItem('iob_tokens');\n        globalThis.sessionStorage.removeItem('iob_tokens');\n    }\n\n    /**\n     * Destroy tokens if they were created by this connection if they expired or invalid\n     *\n     * @param stayLoggedIn if stored in localStorage or in sessionStorage\n     * @param logout if logout is requested\n     */\n    public deleteTokens(stayLoggedIn: boolean, logout?: boolean): void {\n        const tokens = Connection.readTokens();\n        if (tokens) {\n            if (logout) {\n                Connection.deleteTokensStatic();\n            } else if (tokens.stayLoggedIn === stayLoggedIn && tokens.owner === this.connId) {\n                if (tokens.stayLoggedIn) {\n                    globalThis.localStorage.removeItem('iob_tokens');\n                } else {\n                    globalThis.sessionStorage.removeItem('iob_tokens');\n                }\n            }\n        }\n    }\n\n    private onAccessTokenUpdated = (event: StorageEvent): void => {\n        // Storage event is only fired in other tabs/globalThiss (or iframes) of the same origin when the localStorage (or sessionStorage) is modified, and not in the same globalThis where the change was made.\n        if (event.key === 'iob_tokens') {\n            const tokens = Connection.readTokens();\n            if (tokens) {\n                console.log(`Tab ${this.connId} received updated token: ${tokens.access_token}`);\n                this.updateTokenExpiration(tokens.access_token);\n            }\n        }\n    };\n\n    private updateTokenExpiration(accessToken: string): void {\n        // This connection is not a token owner, so only read the new access token and inform the server\n        if (this.lastAccessToken !== accessToken) {\n            this.lastAccessToken = accessToken;\n            this._socket.emit('updateTokenExpiration', accessToken, (err: string | null, success?: boolean): void => {\n                if (err) {\n                    console.error(`[UPDATE/${new Date().toISOString()}] cannot say to server about new token: ${err}`);\n                    globalThis.location.reload();\n                } else if (!success) {\n                    console.error(`[UPDATE/${new Date().toISOString()}] cannot say to server about new token`);\n                    globalThis.location.reload();\n                } else {\n                    console.log(`[UPDATE/${new Date().toISOString()}] server accepted new token: ${accessToken}`);\n                }\n            });\n        }\n\n        this.checkAccessTokenExpire();\n    }\n\n    private refreshTokens(tokenStructure: StoredTokens, takeOwnership?: boolean): void {\n        if (!tokenStructure) {\n            console.log(`[REFRESH/${new Date().toISOString()}] No token structure found => reloading the page`);\n            // Refresh the page, as we cannot refresh the token\n            setTimeout(() => globalThis.location.reload(), 500);\n            return;\n        }\n\n        if (takeOwnership || !tokenStructure.owner || tokenStructure.owner === this.connId) {\n            console.log(`[REFRESH/${new Date().toISOString()}] claim ownership of the token`);\n            if (this.acquireTokenLock()) {\n                console.log(`[REFRESH/${new Date().toISOString()}] refreshing token`);\n                // Access token will expire soon => Send authentication again\n                fetch('./oauth/token', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/x-www-form-urlencoded',\n                    },\n                    body: `grant_type=refresh_token&refresh_token=${tokenStructure.refresh_token}&client_id=ioBroker&stayloggedin=${tokenStructure.stayLoggedIn}`,\n                })\n                    .then(response => {\n                        if (response.ok) {\n                            return response.json();\n                        }\n                        throw new Error('Cannot refresh access token');\n                    })\n                    .then((data: OAuth2Response): void => {\n                        if (data.access_token) {\n                            console.log(\n                                `[REFRESH/${new Date().toISOString()}] received new token: ${data.access_token}`,\n                            );\n                            this.saveTokens(data, tokenStructure.stayLoggedIn);\n\n                            this.releaseTokenLock();\n\n                            this.updateTokenExpiration(data.access_token);\n                        } else {\n                            throw new Error('Cannot get access token');\n                        }\n                    })\n                    .catch(err => {\n                        console.warn(`[REFRESH/${new Date().toISOString()}] cannot refresh token: ${err}`);\n                        this.releaseTokenLock();\n                        this.deleteTokens(tokenStructure.stayLoggedIn);\n                        console.error(err);\n                        globalThis.location.reload();\n                    });\n            } else {\n                console.log(\n                    `[REFRESH/${new Date().toISOString()}] Someone else is updating the token, so wait for the next check`,\n                );\n                // Someone else is updating the token, so wait for the next check\n                this.checkAccessTokenExpire();\n            }\n        } else if (this.lastAccessToken !== tokenStructure.access_token) {\n            this.updateTokenExpiration(tokenStructure.access_token);\n        }\n    }\n\n    /**\n     * Attempts to acquire the semaphore lock.\n     *\n     * @returns True if the lock was acquired successfully; otherwise, false.\n     */\n    acquireTokenLock(): boolean {\n        const now = Date.now();\n        const lock = globalThis.localStorage.getItem('iob_token_semaphore');\n\n        if (lock) {\n            try {\n                const lockData: { expiry: number; connId: string } = JSON.parse(lock);\n                // If the current lock is still valid, we cannot acquire the lock.\n                if (now < lockData.expiry) {\n                    return false;\n                }\n                // Otherwise, the lock has expired and we can override it.\n            } catch {\n                // ignore\n            }\n        }\n\n        // Create a new lock with expiry 10 seconds from now.\n        const newLock: { expiry: number; connId: string } = {\n            connId: this.connId,\n            expiry: now + 10 * 1000, // 10 seconds in milliseconds\n        };\n\n        globalThis.localStorage.setItem('iob_token_semaphore', JSON.stringify(newLock));\n        return true;\n    }\n\n    /** Releases the semaphore lock if it's owned by the given connection ID. */\n    releaseTokenLock(): void {\n        const lock = globalThis.localStorage.getItem('iob_token_semaphore');\n        if (lock) {\n            try {\n                const lockData: { expiry: number; connId: string } = JSON.parse(lock);\n                // Only remove the lock if it's owned by the current connection.\n                if (lockData.connId === this.connId) {\n                    globalThis.localStorage.removeItem('iob_token_semaphore');\n                }\n            } catch {\n                // If parsing fails, remove the lock just in case.\n                globalThis.localStorage.removeItem('iob_token_semaphore');\n            }\n        }\n    }\n\n    private checkAccessTokenExpire(): void {\n        if (this._refreshTimer) {\n            clearTimeout(this._refreshTimer);\n            this._refreshTimer = null;\n        }\n        if (this.isSecure) {\n            const tokens = Connection.readTokens();\n            if (tokens) {\n                const accessExpireInUnixMs = tokens.expires_in.getTime();\n                // Check if the access token expires in the next 30 seconds\n                if (accessExpireInUnixMs < Date.now() + 30_000) {\n                    const takeOwnership = accessExpireInUnixMs < Date.now() + 5_500;\n                    console.log(`[TOKEN/${new Date().toISOString()}] Updating refresh token ${tokens.access_token}`);\n                    if (!tokens.refresh_token) {\n                        console.log(\n                            `[TOKEN/${new Date().toISOString()}] We do not have a refresh token, so we need to reauthenticate`,\n                        );\n                        // Refresh the page, as we cannot refresh the token\n                        setTimeout(\n                            () => globalThis.location.reload(),\n                            Date.now() > accessExpireInUnixMs ? 500 : accessExpireInUnixMs - Date.now(),\n                        );\n                    } else if (\n                        tokens.owner === this.connId ||\n                        // We gave 25 seconds to the owner to update the token, and now we will do it and take the ownership\n                        takeOwnership\n                    ) {\n                        if (tokens.owner === this.connId) {\n                            console.log(`[TOKEN/${new Date().toISOString()}] We are the owner of the token`);\n                        } else {\n                            console.log(\n                                `[TOKEN/${new Date().toISOString()}] We are not the owner of the token, but we will take ownership`,\n                            );\n                        }\n                        // Handle token expiration if the connection is the owner of the token\n                        if (this.props.tokenTimeoutHandler) {\n                            console.log(\n                                `[TOKEN/${new Date().toISOString()}] Asking GUI if we should prolong the token`,\n                            );\n                            // Asc if the user wants to stay logged in\n                            void this.props.tokenTimeoutHandler(accessExpireInUnixMs).then(prolong => {\n                                if (prolong) {\n                                    console.log(`[TOKEN/${new Date().toISOString()}] Token will be prolonged`);\n                                    this.refreshTokens(tokens, takeOwnership);\n                                } else {\n                                    console.log(\n                                        `[TOKEN/${new Date().toISOString()}] Token will not be prolonged. Reloading the page`,\n                                    );\n                                    // Refresh the page, as we cannot refresh the token\n                                    setTimeout(\n                                        () => globalThis.location.reload(),\n                                        Date.now() > accessExpireInUnixMs ? 500 : accessExpireInUnixMs - Date.now(),\n                                    );\n                                }\n                            });\n                        } else {\n                            console.log(\n                                `[TOKEN/${new Date().toISOString()}] No tokenTimeoutHandler defined. Prolonging the token`,\n                            );\n                            this.refreshTokens(tokens, takeOwnership);\n                        }\n                    } else if (this.lastAccessToken !== tokens.access_token) {\n                        console.log(\n                            `[TOKEN/${new Date().toISOString()}] We are not the owner of the token, but we will inform the server about new token`,\n                        );\n                        // The connection is not the owner, so just check if access_token changed, so inform the server about it\n                        this.refreshTokens(tokens);\n                    } else {\n                        console.log(\n                            `[TOKEN/${new Date().toISOString()}] We are not the owner of the token and the token did not change. Check in 3 seconds if the owner updated the token`,\n                        );\n                        // What 3 seconds and check again, maybe the owner connection will update the token\n                        this._refreshTimer = setTimeout(() => {\n                            this._refreshTimer = null;\n                            this.checkAccessTokenExpire();\n                        }, 3_000);\n                    }\n                } else {\n                    this._refreshTimer = setTimeout(\n                        () => {\n                            this._refreshTimer = null;\n                            this.checkAccessTokenExpire();\n                        },\n                        accessExpireInUnixMs - Date.now() - 30_000 > 120_000\n                            ? 120_000\n                            : accessExpireInUnixMs - Date.now() - 30_000,\n                    );\n                }\n            }\n        }\n    }\n\n    /**\n     * Checks if running in ioBroker cloud\n     */\n    static isCloud(): boolean {\n        if (\n            globalThis.location.hostname.includes('amazonaws.com') ||\n            globalThis.location.hostname.includes('iobroker.in')\n        ) {\n            return true;\n        }\n        if (typeof (globalThis as any).socketUrl === 'undefined') {\n            return false;\n        }\n        return (\n            (globalThis as any).socketUrl.includes('iobroker.in') || (globalThis as any).socketUrl.includes('amazonaws')\n        );\n    }\n\n    /**\n     * Checks if the socket is connected.\n     *\n     * @returns true if connected.\n     */\n    isConnected(): boolean {\n        return this.connected;\n    }\n\n    /**\n     * Returns a promise which is resolved when the socket is connected.\n     */\n    waitForFirstConnection(): Promise<void> {\n        return this._waitForFirstConnectionPromise;\n    }\n\n    /**\n     * Called internally.\n     */\n    private async getUserPermissions(): Promise<SocketACL | null> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getUserPermissions', (err, acl?: SocketACL | null): void => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(acl || null);\n                    }\n                });\n            },\n        });\n    }\n\n    /** Loads the important data and retries a couple of times if it takes too long */\n    private async loadData(): Promise<void> {\n        if (this.loaded) {\n            return;\n        }\n        const maxAttempts = 10;\n        for (let i = 1; i <= maxAttempts; i++) {\n            void this.doLoadData().catch(e => console.error(`Cannot load data: ${e}`));\n            if (this.loaded) {\n                return;\n            }\n            // give more time via remote connection\n            await wait(Connection.isCloud() ? 5000 : 1000);\n        }\n    }\n\n    /**\n     * Called after the socket is connected. Loads the necessary data.\n     */\n    private async doLoadData(): Promise<void> {\n        if (this.loaded) {\n            return;\n        }\n\n        // Load ACL if not disabled\n        if (!this.props.doNotLoadACL) {\n            try {\n                this.acl = await this.getUserPermissions();\n            } catch (e) {\n                this.onError(`Cannot read user permissions: ${e}`);\n                return;\n            }\n        }\n\n        // Load system config if not disabled\n        try {\n            if (\n                this.props.admin5only &&\n                !Connection.isWeb() &&\n                (!(globalThis as any).vendorPrefix || (globalThis as any).vendorPrefix === '@@vendorPrefix@@')\n            ) {\n                this._systemConfig = await this.getCompactSystemConfig();\n            } else {\n                this._systemConfig = await this.getSystemConfig();\n            }\n        } catch (e) {\n            this.onError(`Cannot read system config: ${e}`);\n            return;\n        }\n\n        // Detect the system language\n        if (this._systemConfig) {\n            this.systemLang = this._systemConfig.common?.language;\n            if (!this.systemLang) {\n                this.systemLang = ((globalThis.navigator as any).userLanguage || globalThis.navigator.language) as any;\n                // Browsers may report languages like \"de-DE\", \"en-US\", etc.\n                // ioBroker expects \"de\", \"en\", ...\n                if (/^(en|de|ru|pt|nl|fr|it|es|pl|uk)-?/.test(this.systemLang)) {\n                    this.systemLang = this.systemLang.substring(0, 2) as any;\n                } else if (!/^(en|de|ru|pt|nl|fr|it|es|pl|uk|zh-cn)$/.test(this.systemLang)) {\n                    this.systemLang = 'en';\n                }\n                this._systemConfig.common.language = this.systemLang;\n            }\n        }\n        this.props.onLanguage?.(this.systemLang);\n\n        // We are now connected\n        this.loaded = true;\n        this.props.onProgress?.(PROGRESS.CONNECTED);\n        this.firstConnect = false;\n\n        // Load all objects if desired\n        if (!this.props.doNotLoadAllObjects) {\n            this.objects = await this.getObjects();\n        } else if (this.props.admin5only) {\n            this.objects = {};\n        } else {\n            this.objects = { 'system.config': this._systemConfig };\n        }\n\n        this.props.onProgress?.(PROGRESS.READY);\n        if (!this.onReadyDone) {\n            this.onReadyDone = true;\n            this.props.onReady?.(this.objects);\n        }\n    }\n\n    /**\n     * Called internally.\n     */\n    private authenticate(): void {\n        if (globalThis.location.search.includes('&href=')) {\n            globalThis.location.href = `${globalThis.location.protocol}//${globalThis.location.host}${globalThis.location.pathname}${globalThis.location.search}`;\n        } else {\n            globalThis.location.href = `${globalThis.location.protocol}//${globalThis.location.host}${globalThis.location.pathname}?login&href=${encodeURIComponent(globalThis.location.search + globalThis.location.hash)}`;\n        }\n    }\n\n    /**\n     * Subscribe to the changes of the given state.\n     * In compare to the subscribeObject method,\n     * this method calls the handler with the current state value immediately after subscribing.\n     *\n     * @param id The ioBroker state ID or array of state IDs.\n     * @param binary Set to true if the given state is binary and requires Base64 decoding.\n     * @param cb The callback.\n     */\n    subscribeState(id: string | string[], binary: true, cb: BinaryStateChangeHandler): Promise<void>;\n\n    subscribeState(id: string | string[], binary: false, cb: ioBroker.StateChangeHandler): Promise<void>;\n\n    subscribeState(id: string | string[], cb: ioBroker.StateChangeHandler): Promise<void>;\n\n    async subscribeState(\n        ...args:\n            | [id: string | string[], binary: true, cb: BinaryStateChangeHandler]\n            | [id: string | string[], binary: false, cb: ioBroker.StateChangeHandler]\n            | [id: string | string[], cb: ioBroker.StateChangeHandler]\n    ): Promise<void> {\n        let id: string | string[];\n        let binary: boolean;\n        let cb: ioBroker.StateChangeHandler | BinaryStateChangeHandler;\n        if (args.length === 3) {\n            [id, binary, cb] = args;\n        } else {\n            [id, cb] = args;\n            binary = false;\n        }\n        let ids: string[];\n        if (!Array.isArray(id)) {\n            ids = [id];\n        } else {\n            ids = id;\n        }\n\n        if (typeof cb !== 'function') {\n            throw new Error('The state change handler must be a function!');\n        }\n        const toSubscribe: string[] = [];\n        for (let i = 0; i < ids.length; i++) {\n            const _id = ids[i];\n            if (!this.statesSubscribes[_id]) {\n                this.statesSubscribes[_id] = {\n                    reg: new RegExp(pattern2RegEx(_id)),\n                    cbs: [cb],\n                };\n                if (id !== this.ignoreState) {\n                    toSubscribe.push(_id);\n                }\n            } else {\n                !this.statesSubscribes[_id].cbs.includes(cb) && this.statesSubscribes[_id].cbs.push(cb);\n            }\n        }\n\n        if (!this.connected) {\n            return;\n        }\n\n        if (toSubscribe.length) {\n            // no answer from server required\n            this._socket.emit('subscribe', toSubscribe);\n        }\n\n        // Try to get the current value(s) of the state(s) and call the change handlers\n        if (binary) {\n            let base64: string | undefined;\n            for (let i = 0; i < ids.length; i++) {\n                try {\n                    // binary states are deprecated\n                    base64 = await this.getBinaryState(ids[i]);\n                } catch (e) {\n                    console.error(`Cannot getBinaryState \"${ids[i]}\": ${JSON.stringify(e)}`);\n                    base64 = undefined;\n                }\n                if (base64 != undefined) {\n                    (cb as BinaryStateChangeHandler)(ids[i], base64);\n                }\n            }\n        } else if (ids.find(_id => _id.includes('*'))) {\n            let states: Record<string, ioBroker.State> | undefined;\n            for (let i = 0; i < ids.length; i++) {\n                try {\n                    states = await this.getForeignStates(ids[i]);\n                } catch (e) {\n                    console.error(`Cannot getForeignStates \"${ids[i]}\": ${JSON.stringify(e)}`);\n                    return;\n                }\n                if (states) {\n                    for (const [id, state] of Object.entries(states)) {\n                        const mayBePromise = (cb as ioBroker.StateChangeHandler)(id, state);\n                        if (mayBePromise instanceof Promise) {\n                            void mayBePromise.catch(e => console.error(`Cannot call state change handler: ${e}`));\n                        }\n                    }\n                }\n            }\n        } else {\n            try {\n                const states = await (Connection.isWeb() ? this.getStates(ids) : this.getForeignStates(ids));\n                if (states) {\n                    for (const [id, state] of Object.entries(states)) {\n                        const mayBePromise = (cb as ioBroker.StateChangeHandler)(id, state);\n                        if (mayBePromise instanceof Promise) {\n                            void mayBePromise.catch(e => console.error(`Cannot call state change handler: ${e}`));\n                        }\n                    }\n                }\n            } catch (e) {\n                console.error(`Cannot getState \"${ids.join(', ')}\": ${e.message}`);\n                return;\n            }\n        }\n    }\n\n    /**\n     * Subscribe to the changes of the given state and wait for answer.\n     *\n     * @param id The ioBroker state ID.\n     * @param cb The callback.\n     */\n    async subscribeStateAsync(id: string | string[], cb: ioBroker.StateChangeHandler): Promise<void> {\n        return this.subscribeState(id, cb);\n    }\n\n    /**\n     * Unsubscribes the given callback from changes of the given state.\n     *\n     * @param id The ioBroker state ID or array of state IDs.\n     * @param cb The callback.\n     */\n    unsubscribeState(id: string | string[], cb?: ioBroker.StateChangeHandler): void {\n        let ids: string[];\n        if (!Array.isArray(id)) {\n            ids = [id];\n        } else {\n            ids = id;\n        }\n        const toUnsubscribe = [];\n        for (let i = 0; i < ids.length; i++) {\n            const _id = ids[i];\n\n            if (this.statesSubscribes[_id]) {\n                const sub = this.statesSubscribes[_id];\n                if (cb) {\n                    const pos = sub.cbs.indexOf(cb);\n                    pos !== -1 && sub.cbs.splice(pos, 1);\n                } else {\n                    sub.cbs = [];\n                }\n\n                if (!sub.cbs?.length) {\n                    delete this.statesSubscribes[_id];\n                    if (_id !== this.ignoreState) {\n                        toUnsubscribe.push(_id);\n                    }\n                }\n            }\n        }\n        if (this.connected && toUnsubscribe.length) {\n            this._socket.emit('unsubscribe', ids);\n        }\n    }\n\n    /**\n     * Subscribe to changes of the given object.\n     * In compare to the subscribeState method,\n     * this method does not call the handler with the current value immediately after subscribe.\n     *\n     * the current value.\n     *\n     * @param id The ioBroker object ID.\n     * @param cb The callback.\n     */\n    subscribeObject(id: string | string[], cb: ObjectChangeHandler): Promise<void> {\n        let ids: string[];\n        if (!Array.isArray(id)) {\n            ids = [id];\n        } else {\n            ids = id;\n        }\n\n        if (typeof cb !== 'function') {\n            throw new Error('The object change handler must be a function!');\n        }\n\n        const toSubscribe: string[] = [];\n        for (let i = 0; i < ids.length; i++) {\n            const _id = ids[i];\n            if (!this.objectsSubscribes[_id]) {\n                this.objectsSubscribes[_id] = {\n                    reg: new RegExp(pattern2RegEx(_id)),\n                    cbs: [cb],\n                };\n                toSubscribe.push(_id);\n            } else {\n                !this.objectsSubscribes[_id].cbs.includes(cb) && this.objectsSubscribes[_id].cbs.push(cb);\n            }\n        }\n\n        if (this.connected && toSubscribe.length) {\n            this._socket.emit('subscribeObjects', toSubscribe);\n        }\n\n        return Promise.resolve();\n    }\n\n    /**\n     * Unsubscribes all callbacks from changes of the given object.\n     *\n     * @param id The ioBroker object ID.\n     */\n    /**\n     * Unsubscribes the given callback from changes of the given object.\n     *\n     * @param id The ioBroker object ID.\n     * @param cb The callback.\n     */\n    unsubscribeObject(id: string | string[], cb?: ObjectChangeHandler): Promise<void> {\n        let ids: string[];\n        if (!Array.isArray(id)) {\n            ids = [id];\n        } else {\n            ids = id;\n        }\n        const toUnsubscribe: string[] = [];\n        for (let i = 0; i < ids.length; i++) {\n            const _id = ids[i];\n            if (this.objectsSubscribes[_id]) {\n                const sub = this.objectsSubscribes[_id];\n                if (cb) {\n                    const pos = sub.cbs.indexOf(cb);\n                    pos !== -1 && sub.cbs.splice(pos, 1);\n                } else {\n                    sub.cbs = [];\n                }\n\n                if (!sub.cbs?.length) {\n                    delete this.objectsSubscribes[_id];\n                    toUnsubscribe.push(_id);\n                }\n            }\n        }\n        if (this.connected && toUnsubscribe.length) {\n            this._socket.emit('unsubscribeObjects', toUnsubscribe);\n        }\n        return Promise.resolve();\n    }\n\n    /**\n     * Called internally.\n     *\n     * @param id The ioBroker object ID.\n     * @param obj The new object.\n     */\n    private objectChange(id: string, obj: ioBroker.Object | null | undefined): void {\n        // update main.objects cache\n\n        // Remember the id and type of th old object\n        let oldObj: OldObject | undefined;\n        if (this.objects[id]) {\n            oldObj = { _id: id, type: this.objects[id].type };\n        }\n\n        let changed = false;\n        if (obj) {\n            // The object was added, updated or changed\n\n            // Copy the _rev property (whatever that is)\n            if ((obj as any)._rev && this.objects[id]) {\n                (this.objects[id] as any)._rev = (obj as any)._rev;\n            }\n\n            // Detect if there was a change\n            if (!this.objects[id] || JSON.stringify(this.objects[id]) !== JSON.stringify(obj)) {\n                this.objects[id] = obj;\n                changed = true;\n            }\n        } else if (this.objects[id]) {\n            // The object was deleted\n            delete this.objects[id];\n            changed = true;\n        }\n\n        // Notify all subscribed listeners\n        for (const [_id, sub] of Object.entries(this.objectsSubscribes)) {\n            if (_id === id || sub.reg.test(id)) {\n                sub.cbs.forEach(cb => {\n                    try {\n                        const mayBePromise = cb(id, obj, oldObj);\n                        if (mayBePromise instanceof Promise) {\n                            void mayBePromise.catch(e => console.error(`Cannot call object change handler: ${e}`));\n                        }\n                    } catch (e) {\n                        console.error(`Error by callback of objectChange: ${e}`);\n                    }\n                });\n            }\n        }\n\n        // Notify the default listener on change\n        if (changed) {\n            const mayBePromise = this.props.onObjectChange?.(id, obj);\n            if (mayBePromise instanceof Promise) {\n                void mayBePromise.catch(e => console.error(`Cannot call object change handler: ${e}`));\n            }\n        }\n    }\n\n    /**\n     * Called internally.\n     *\n     * @param id The ioBroker state ID.\n     * @param state The new state value.\n     */\n    private stateChange(id: string, state: ioBroker.State | null | undefined): void {\n        for (const sub of Object.values(this.statesSubscribes)) {\n            if (sub.reg.test(id)) {\n                for (const cb of sub.cbs) {\n                    try {\n                        const mayBePromise = cb(id, (state ?? null) as any);\n                        if (mayBePromise instanceof Promise) {\n                            void mayBePromise.catch(e => console.error(`Cannot call state change handler: ${e}`));\n                        }\n                    } catch (e) {\n                        console.error(`Error by callback of stateChanged: ${e}`);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Called internally.\n     *\n     * @param messageType The message type from the instance\n     * @param sourceInstance The source instance\n     * @param data The message data\n     */\n    private instanceMessage(messageType: string, sourceInstance: string, data: any): void {\n        this._instanceSubscriptions[sourceInstance]?.forEach(sub => {\n            if (sub.messageType === messageType) {\n                const mayBePromise = sub.callback(data, sourceInstance, messageType);\n                if (mayBePromise instanceof Promise) {\n                    void mayBePromise.catch(e => console.error(`Cannot call instance message handler: ${e}`));\n                }\n            }\n        });\n    }\n\n    /**\n     * Called internally.\n     *\n     * @param id The ioBroker object ID of type 'meta'.\n     * @param fileName - file name\n     * @param size - size of the file\n     */\n    private fileChange(id: string, fileName: string, size: number | null): void {\n        for (const sub of Object.values(this.filesSubscribes)) {\n            if (sub.regId.test(id) && sub.regFilePattern.test(fileName)) {\n                for (const cb of sub.cbs) {\n                    try {\n                        cb(id, fileName, size);\n                    } catch (e) {\n                        console.error(`Error by callback of fileChange: ${e}`);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Subscribe to changes of the files.\n     *\n     * @param id The ioBroker state ID for a \"meta\" object. Could be a pattern\n     * @param filePattern Pattern or file name, like 'main/*' or 'main/visViews.json`\n     * @param cb The callback.\n     */\n    async subscribeFiles(id: string, filePattern: string | string[], cb: FileChangeHandler): Promise<void> {\n        if (typeof cb !== 'function') {\n            throw new Error('The state change handler must be a function!');\n        }\n\n        let filePatterns: string[];\n        if (Array.isArray(filePattern)) {\n            filePatterns = filePattern;\n        } else {\n            filePatterns = [filePattern];\n        }\n\n        const toSubscribe = [];\n        for (let f = 0; f < filePatterns.length; f++) {\n            const pattern = filePatterns[f];\n            const key = `${id}$%$${pattern}`;\n\n            if (!this.filesSubscribes[key]) {\n                this.filesSubscribes[key] = {\n                    regId: new RegExp(pattern2RegEx(id)),\n                    regFilePattern: new RegExp(pattern2RegEx(pattern)),\n                    cbs: [cb],\n                };\n                toSubscribe.push(pattern);\n            } else {\n                !this.filesSubscribes[key].cbs.includes(cb) && this.filesSubscribes[key].cbs.push(cb);\n            }\n        }\n        if (this.connected && toSubscribe.length) {\n            this._socket.emit('subscribeFiles', id, toSubscribe);\n        }\n\n        return Promise.resolve();\n    }\n\n    /**\n     * Unsubscribes the given callback from changes of files.\n     *\n     * @param id The ioBroker state ID.\n     * @param filePattern Pattern or file name, like 'main/*' or 'main/visViews.json`\n     * @param cb The callback.\n     */\n    unsubscribeFiles(id: string, filePattern: string | string[], cb?: FileChangeHandler): void {\n        let filePatterns: string[];\n        if (Array.isArray(filePattern)) {\n            filePatterns = filePattern;\n        } else {\n            filePatterns = [filePattern];\n        }\n        const toUnsubscribe = [];\n        for (let f = 0; f < filePatterns.length; f++) {\n            const pattern = filePatterns[f];\n            const key = `${id}$%$${pattern}`;\n            if (this.filesSubscribes[key]) {\n                const sub = this.filesSubscribes[key];\n                if (cb) {\n                    const pos = sub.cbs.indexOf(cb);\n                    pos !== -1 && sub.cbs.splice(pos, 1);\n                } else {\n                    sub.cbs = [];\n                }\n\n                if (!sub.cbs?.length) {\n                    delete this.filesSubscribes[key];\n                    toUnsubscribe.push(pattern);\n                }\n            }\n        }\n        if (this.connected && toUnsubscribe.length) {\n            this._socket.emit('unsubscribeFiles', id, toUnsubscribe);\n        }\n    }\n\n    /** Requests data from the server or reads it from the cache */\n    protected async request<T>({\n        cacheKey,\n        forceUpdate,\n        commandTimeout,\n        onTimeout,\n        requireAdmin,\n        requireFeatures,\n        // requestName,\n        executor,\n    }: RequestOptions<T>): Promise<T> {\n        // TODO: mention requestName in errors\n\n        // If the command requires the admin adapter, enforce it\n        if (requireAdmin && Connection.isWeb()) {\n            return Promise.reject(new Error(ERRORS.NOT_ADMIN));\n        }\n\n        // Return the cached value if allowed\n        if (cacheKey && !forceUpdate && cacheKey in this._promises) {\n            return this._promises[cacheKey];\n        }\n\n        // Require the socket to be connected\n        if (!this.connected) {\n            return Promise.reject(new Error(ERRORS.NOT_CONNECTED));\n        }\n\n        // Check if all required features are supported\n        if (requireFeatures?.length) {\n            for (const feature of requireFeatures) {\n                if (!(await this.checkFeatureSupported(feature))) {\n                    throw new Error(ERRORS.NOT_SUPPORTED);\n                }\n            }\n        }\n\n        // eslint-disable-next-line no-async-promise-executor\n        const promise = new Promise<T>(async (resolve, reject) => {\n            const timeoutControl = {\n                elapsed: false,\n                clearTimeout: () => {\n                    // no-op unless there is a timeout\n                },\n            };\n            let timeout: ReturnType<typeof setTimeout> | undefined;\n            if (commandTimeout !== false) {\n                timeout = setTimeout(() => {\n                    timeoutControl.elapsed = true;\n                    // Let the caller know that the timeout elapsed\n                    onTimeout?.();\n\n                    // do not cache responses with timeout or no connection\n                    if (cacheKey && this._promises[cacheKey] instanceof Promise) {\n                        delete this._promises[cacheKey];\n                    }\n                    reject(new Error(ERRORS.TIMEOUT));\n                }, commandTimeout ?? this.props.cmdTimeout);\n                timeoutControl.clearTimeout = () => {\n                    clearTimeout(timeout);\n                };\n            }\n            // Call the actual function - awaiting it allows us to catch sync and async errors\n            // no matter if the executor is async or not\n            try {\n                await executor(resolve, reject, timeoutControl);\n            } catch (e) {\n                // do not cache responses with timeout or no connection\n                if (cacheKey && this._promises[cacheKey] instanceof Promise) {\n                    delete this._promises[cacheKey];\n                }\n                reject(new Error(e.toString()));\n            }\n        });\n        if (cacheKey) {\n            this._promises[cacheKey] = promise;\n        }\n        return promise;\n    }\n\n    /**\n     * Deletes cached promise.\n     * So next time the information will be requested anew\n     */\n    resetCache(key: string, isAll?: boolean): void {\n        if (isAll) {\n            Object.keys(this._promises)\n                .filter(k => k.startsWith(key))\n                .forEach(k => {\n                    delete this._promises[k];\n                });\n        } else {\n            delete this._promises[key];\n        }\n    }\n\n    /**\n     * Gets all states.\n     *\n     * @param pattern Pattern of states or array of IDs\n     */\n    getStates(pattern?: string | string[]): Promise<Record<string, ioBroker.State>> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getStates', pattern, (err, res) => {\n                    this.states = res ?? {};\n\n                    // if (!disableProgressUpdate) {\n                    // \tthis.props.onProgress?.(PROGRESS.STATES_LOADED);\n                    // }\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(this.states);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Gets the given state.\n     *\n     * @param id The state ID.\n     */\n    getState(id: string): Promise<ioBroker.State | null | undefined> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                if (id && id === this.ignoreState) {\n                    resolve(this.simStates[id] || { val: null, ack: true });\n                    return;\n                }\n                this._socket.emit('getState', id, (err, state) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(state);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Gets the given binary state Base64 encoded.\n     *\n     * @deprecated since js-controller 5.0. Use files instead.\n     * @param id The state ID.\n     */\n    getBinaryState(id: string): Promise<string | undefined> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getBinaryState', id, (err, state) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(state);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Sets the given binary state.\n     *\n     * @deprecated since js-controller 5.0. Use files instead.\n     * @param id The state ID.\n     * @param base64 The Base64 encoded binary data.\n     */\n    setBinaryState(id: string, base64: string): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('setBinaryState', id, base64, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Sets the given state value.\n     *\n     * @param id The state ID.\n     * @param val The state value.\n     * @param ack Acknowledgement flag.\n     */\n    setState(\n        id: string,\n        val: ioBroker.State | ioBroker.StateValue | ioBroker.SettableState,\n        ack?: boolean,\n    ): Promise<void> {\n        if (typeof ack === 'boolean') {\n            val = { val: val as ioBroker.StateValue, ack };\n        }\n\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                // extra handling for \"nothing_selected\" state for vis\n                if (id && id === this.ignoreState) {\n                    let state: ioBroker.State;\n\n                    if (typeof ack === 'boolean') {\n                        state = val as ioBroker.State;\n                    } else if (typeof val === 'object' && (val as ioBroker.State).val !== undefined) {\n                        state = val as ioBroker.State;\n                    } else {\n                        state = {\n                            val: val as ioBroker.StateValue,\n                            ack: false,\n                            ts: Date.now(),\n                            lc: Date.now(),\n                            from: 'system.adapter.vis.0',\n                        };\n                    }\n\n                    this.simStates[id] = state;\n\n                    // inform subscribers about changes\n                    if (this.statesSubscribes[id]) {\n                        for (const cb of this.statesSubscribes[id].cbs) {\n                            try {\n                                const mayBePromise = cb(id, state as any);\n                                if (mayBePromise instanceof Promise) {\n                                    void mayBePromise.catch(e =>\n                                        console.error(`Cannot call state change handler: ${e}`),\n                                    );\n                                }\n                            } catch (e) {\n                                console.error(`Error by callback of stateChanged: ${e}`);\n                            }\n                        }\n                    }\n                    resolve();\n                    return;\n                }\n                this._socket.emit('setState', id, val, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Gets all objects.\n     *\n     * @param update Callback that is executed when all objects are retrieved.\n     */\n    /**\n     * Gets all objects.\n     *\n     * @param update Set to true to retrieve all objects from the server (instead of using the local cache).\n     * @param disableProgressUpdate don't call onProgress() when done\n     */\n    getObjects(update?: boolean, disableProgressUpdate?: boolean): Promise<Record<string, ioBroker.Object>> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                if (!update && this.objects) {\n                    resolve(this.objects);\n                    return;\n                }\n\n                this._socket.emit(Connection.isWeb() ? 'getObjects' : 'getAllObjects', (err, res) => {\n                    if (!disableProgressUpdate) {\n                        this.props.onProgress?.(PROGRESS.OBJECTS_LOADED);\n                    }\n                    if (err) {\n                        reject(err);\n                    } else {\n                        this.objects = res ?? {};\n                        resolve(this.objects);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Gets the list of objects by ID.\n     *\n     * @param list array of IDs to retrieve\n     */\n    getObjectsById(list: string[]): Promise<Record<string, ioBroker.Object> | undefined> {\n        return this.request({\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getObjects', list, (err, res) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(res);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Called internally.\n     *\n     * @param isEnable Set to true if subscribing, false to unsubscribe.\n     */\n    private _subscribe(isEnable: boolean): void {\n        if (isEnable && !this.subscribed) {\n            this.subscribed = true;\n            if (this.props.autoSubscribes?.length) {\n                this._socket.emit('subscribeObjects', this.props.autoSubscribes);\n            }\n            // re subscribe objects\n            const ids = Object.keys(this.objectsSubscribes);\n            if (ids.length) {\n                this._socket.emit('subscribeObjects', ids);\n            }\n            Object.keys(this.objectsSubscribes).forEach(id => this._socket.emit('subscribeObjects', id));\n            // re-subscribe logs\n            this.props.autoSubscribeLog && this._socket.emit('requireLog', true);\n            // re subscribe states\n            Object.keys(this.statesSubscribes).forEach(id => this._socket.emit('subscribe', id));\n            // re-subscribe files\n            Object.keys(this.filesSubscribes).forEach(key => {\n                const [id, filePattern] = key.split('$%$');\n                this._socket.emit('subscribeFiles', id, filePattern);\n            });\n        } else if (!isEnable && this.subscribed) {\n            this.subscribed = false;\n            // un-subscribe objects\n            if (this.props.autoSubscribes?.length) {\n                this._socket.emit('unsubscribeObjects', this.props.autoSubscribes);\n            }\n            const ids = Object.keys(this.objectsSubscribes);\n            if (ids.length) {\n                this._socket.emit('unsubscribeObjects', ids);\n            }\n            // un-subscribe logs\n            this.props.autoSubscribeLog && this._socket.emit('requireLog', false);\n\n            // un-subscribe states\n            Object.keys(this.statesSubscribes).forEach(id => this._socket.emit('unsubscribe', id));\n            // re-subscribe files\n            Object.keys(this.filesSubscribes).forEach(key => {\n                const [id, filePattern] = key.split('$%$');\n                this._socket.emit('unsubscribeFiles', id, filePattern);\n            });\n        }\n    }\n\n    /**\n     * Requests log updates.\n     *\n     * @param isEnabled Set to true to get logs.\n     */\n    requireLog(isEnabled: boolean): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('requireLog', isEnabled, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Deletes the given object.\n     *\n     * @param id The object ID.\n     * @param maintenance Force deletion of non conform IDs.\n     */\n    delObject(id: string, maintenance: boolean = false): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('delObject', id, { maintenance }, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Deletes the given object and all its children.\n     *\n     * @param id The object ID.\n     * @param maintenance Force deletion of non conform IDs.\n     */\n    delObjects(id: string, maintenance: boolean): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('delObjects', id, { maintenance }, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Sets the object.\n     *\n     * @param id The object ID.\n     * @param obj The object.\n     */\n    setObject(id: string, obj: ioBroker.SettableObject): Promise<void> {\n        if (!obj) {\n            return Promise.reject(new Error('Null object is not allowed'));\n        }\n\n        obj = JSON.parse(JSON.stringify(obj));\n        delete obj.from;\n        delete obj.user;\n        delete obj.ts;\n\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('setObject', id, obj, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Gets the object with the given id from the server.\n     *\n     * @param id The object ID.\n     * @returns The object.\n     */\n    getObject<T extends string>(id: T): ioBroker.GetObjectPromise<T> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                if (id && id === this.ignoreState) {\n                    resolve({\n                        _id: this.ignoreState,\n                        type: 'state',\n                        common: {\n                            name: 'ignored state',\n                            type: 'mixed',\n                        },\n                    } as any);\n                    return;\n                }\n                this._socket.emit('getObject', id, (err, obj) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(obj as any);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Sends a message to a specific instance or all instances of some specific adapter.\n     *\n     * @param instance The instance to send this message to.\n     * @param command Command name of the target instance.\n     * @param data The message data to send.\n     */\n    sendTo<T = any>(instance: string, command: string, data?: any): Promise<T> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: resolve => {\n                this._socket.emit('sendTo', instance, command, data, (result: any) => {\n                    resolve(result);\n                });\n            },\n        });\n    }\n\n    /**\n     * Extend an object and create it if it might not exist.\n     *\n     * @param id The id.\n     * @param obj The object.\n     */\n    extendObject(id: string, obj: ioBroker.PartialObject): Promise<void> {\n        if (!obj) {\n            return Promise.reject(new Error('Null object is not allowed'));\n        }\n\n        obj = JSON.parse(JSON.stringify(obj));\n        delete obj.from;\n        delete obj.user;\n        delete obj.ts;\n\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('extendObject', id, obj, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Register a handler for log messages.\n     *\n     * @param handler The handler.\n     */\n    registerLogHandler(handler: (message: LogMessage) => void): void {\n        if (!this.onLogHandlers.includes(handler)) {\n            this.onLogHandlers.push(handler);\n        }\n    }\n\n    /**\n     * Unregister a handler for log messages.\n     *\n     * @param handler The handler.\n     */\n    unregisterLogHandler(handler: (message: LogMessage) => void): void {\n        const pos = this.onLogHandlers.indexOf(handler);\n        pos !== -1 && this.onLogHandlers.splice(pos, 1);\n    }\n\n    /**\n     * Register a handler for the connection state.\n     *\n     * @param handler The handler.\n     */\n    registerConnectionHandler(handler: (connected: boolean) => void): void {\n        if (!this.onConnectionHandlers.includes(handler)) {\n            this.onConnectionHandlers.push(handler);\n        }\n    }\n\n    /**\n     * Unregister a handler for the connection state.\n     *\n     * @param handler The handler.\n     */\n    unregisterConnectionHandler(handler: (connected: boolean) => void): void {\n        const pos = this.onConnectionHandlers.indexOf(handler);\n        pos !== -1 && this.onConnectionHandlers.splice(pos, 1);\n    }\n\n    /**\n     * Set the handler for standard output of a command.\n     *\n     * @param handler The handler.\n     */\n    registerCmdStdoutHandler(handler: (id: string, text: string) => void): void {\n        this.onCmdStdoutHandler = handler;\n    }\n\n    /**\n     * Unset the handler for standard output of a command.\n     */\n    unregisterCmdStdoutHandler(): void {\n        this.onCmdStdoutHandler = undefined;\n    }\n\n    /**\n     * Set the handler for standard error of a command.\n     *\n     * @param handler The handler.\n     */\n    registerCmdStderrHandler(handler: (id: string, text: string) => void): void {\n        this.onCmdStderrHandler = handler;\n    }\n\n    /**\n     * Unset the handler for standard error of a command.\n     */\n    unregisterCmdStderrHandler(): void {\n        this.onCmdStderrHandler = undefined;\n    }\n\n    /**\n     * Set the handler for exit of a command.\n     *\n     * @param handler The handler.\n     */\n    registerCmdExitHandler(handler: (id: string, exitCode: number) => void): void {\n        this.onCmdExitHandler = handler;\n    }\n\n    /**\n     * Unset the handler for exit of a command.\n     */\n    unregisterCmdExitHandler(): void {\n        this.onCmdExitHandler = undefined;\n    }\n\n    /**\n     * Get all enums with the given name.\n     *\n     * @param _enum The name of the enum, like `rooms` or `functions`\n     * @param update Force update.\n     */\n    getEnums(_enum?: string, update?: boolean): Promise<Record<string, ioBroker.EnumObject>> {\n        return this.request({\n            cacheKey: `enums_${_enum || 'all'}`,\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit(\n                    'getObjectView',\n                    'system',\n                    'enum',\n                    {\n                        startkey: `enum.${_enum || ''}`,\n                        endkey: _enum ? `enum.${_enum}.\\u9999` : `enum.\\u9999`,\n                    },\n                    (err, res) => {\n                        if (err) {\n                            reject(err);\n                        } else {\n                            const _res: Record<string, ioBroker.EnumObject> = {};\n                            if (res) {\n                                for (let i = 0; i < res.rows.length; i++) {\n                                    if (_enum && res.rows[i].id === `enum.${_enum}`) {\n                                        continue;\n                                    }\n                                    _res[res.rows[i].id] = res.rows[i].value as ioBroker.EnumObject;\n                                }\n                            }\n                            resolve(_res);\n                        }\n                    },\n                );\n            },\n        });\n    }\n\n    /**\n     * @deprecated since version 1.1.15, cause parameter order does not match backend\n     * Query a predefined object view.\n     * @param start The start ID.\n     * @param end The end ID.\n     * @param type The type of object.\n     */\n    getObjectView<T extends ioBroker.ObjectType>(\n        start: string | undefined,\n        end: string | undefined,\n        type: T,\n    ): Promise<Record<string, ioBroker.AnyObject & { type: T }>> {\n        return this.getObjectViewCustom('system', type, start, end);\n    }\n\n    /**\n     * Query a predefined object view.\n     *\n     * @param type The type of object.\n     * @param start The start ID.\n     * @param [end] The end ID.\n     */\n    async getObjectViewSystem<T extends ioBroker.ObjectType>(\n        type: T,\n        start?: string,\n        end?: string,\n    ): Promise<Record<string, ioBroker.AnyObject & { type: T }>> {\n        const key = `${type}_${start || ''}_${end || ''}`;\n        const result = await this.getObjectViewCustom('system', type, start, end);\n        if (this.objectViewCached?.[key]) {\n            // update cached value\n            this.objectViewCached[key] = result;\n        }\n        return result;\n    }\n\n    /**\n     * Query a predefined object view.\n     *\n     * @param type The type of object.\n     * @param start The start ID.\n     * @param [end] The end ID.\n     */\n    async getObjectViewSystemCached<T extends ioBroker.ObjectType>(\n        type: T,\n        start?: string,\n        end?: string,\n    ): Promise<Record<string, ioBroker.AnyObject & { type: T }>> {\n        const key = `${type}_${start || ''}_${end || ''}`;\n        if (this.objectViewCached?.[key]) {\n            return Promise.resolve(this.objectViewCached[key] as any);\n        }\n\n        const result = await this.getObjectViewCustom('system', type, start, end);\n        this.objectViewCached ||= {};\n        this.objectViewCached[key] = result;\n        return result;\n    }\n\n    /**\n     * Query a predefined object view.\n     *\n     * @param design design - 'system' or other designs like `custom`.\n     * @param type The type of object.\n     * @param start The start ID.\n     * @param [end] The end ID.\n     */\n    getObjectViewCustom<T extends ioBroker.ObjectType>(\n        design: string,\n        type: T,\n        start?: string,\n        end?: string,\n    ): Promise<Record<string, ioBroker.AnyObject & { type: T }>> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                start ||= '';\n                end ||= '\\u9999';\n\n                this._socket.emit('getObjectView', design, type, { startkey: start, endkey: end }, (err, res) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        const _res: Record<string, ioBroker.AnyObject & { type: T }> = {};\n                        if (res && res.rows) {\n                            for (let i = 0; i < res.rows.length; i++) {\n                                _res[res.rows[i].id] = res.rows[i].value;\n                            }\n                        }\n                        resolve(_res);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Read the meta items.\n     */\n    readMetaItems(): Promise<ioBroker.Object[]> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit(\n                    'getObjectView',\n                    'system',\n                    'meta',\n                    { startkey: '', endkey: '\\u9999' },\n                    (err, objs) => {\n                        if (err) {\n                            reject(err);\n                        } else {\n                            resolve(objs!.rows?.map(obj => obj.value).filter((val): val is ioBroker.Object => !!val));\n                        }\n                    },\n                );\n            },\n        });\n    }\n\n    /**\n     * Read the directory of an adapter.\n     *\n     * @param namespace (this may be the adapter name, the instance name or the name of a storage object within the adapter).\n     * @param path The directory name.\n     */\n    readDir(namespace: string | null, path: string): Promise<ioBroker.ReadDirResult[]> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('readDir', namespace, path, (err, files) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(files!);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Read a file of an adapter.\n     *\n     * @param namespace (this may be the adapter name, the instance name or the name of a storage object within the adapter).\n     * @param fileName The file name.\n     * @param base64 If it must be a base64 format\n     */\n    readFile(\n        namespace: string | null,\n        fileName: string,\n        base64?: boolean,\n    ): Promise<{ file: string; mimeType: string }> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit(base64 ? 'readFile64' : 'readFile', namespace, fileName, (err, data, type) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve({ file: data as string, mimeType: type! });\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Write a file of an adapter.\n     *\n     * @param namespace (this may be the adapter name, the instance name or the name of a storage object within the adapter).\n     * @param fileName The file name.\n     * @param data The data (if it's a Buffer, it will be converted to Base64).\n     */\n    writeFile64(namespace: string, fileName: string, data: ArrayBuffer | string): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                if (typeof data === 'string') {\n                    this._socket.emit('writeFile', namespace, fileName, data, err => {\n                        if (err) {\n                            reject(err);\n                        } else {\n                            resolve();\n                        }\n                    });\n                } else {\n                    const base64 = btoa(\n                        new Uint8Array(data).reduce((data, byte) => data + String.fromCharCode(byte), ''),\n                    );\n\n                    this._socket.emit('writeFile64', namespace, fileName, base64, err => {\n                        if (err) {\n                            reject(err);\n                        } else {\n                            resolve();\n                        }\n                    });\n                }\n            },\n        });\n    }\n\n    /**\n     * Delete a file of an adapter.\n     *\n     * @param namespace (this may be the adapter name, the instance name or the name of a storage object within the adapter).\n     * @param fileName The file name.\n     */\n    deleteFile(namespace: string, fileName: string): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('deleteFile', namespace, fileName, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Delete a folder of an adapter.\n     *\n     * @param namespace (this may be the adapter name, the instance name or the name of a storage object within the adapter).\n     * @param folderName The folder name.\n     */\n    deleteFolder(namespace: string, folderName: string): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('deleteFolder', namespace, folderName, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Rename file or folder in ioBroker DB\n     *\n     * @param namespace (this may be the adapter name, the instance name or the name of a storage object within the adapter).\n     * @param oldName current file name, e.g., main/vis-views.json\n     * @param newName new file name, e.g., main/vis-views-new.json\n     */\n    rename(namespace: string, oldName: string, newName: string): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('rename', namespace, oldName, newName, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Rename file in ioBroker DB\n     *\n     * @param namespace (this may be the adapter name, the instance name or the name of a storage object within the adapter).\n     * @param oldName current file name, e.g., main/vis-views.json\n     * @param newName new file name, e.g., main/vis-views-new.json\n     */\n    renameFile(namespace: string, oldName: string, newName: string): Promise<void> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('renameFile', namespace, oldName, newName, err => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Execute a command on a host.\n     */\n    cmdExec(\n        /** Host name */\n        host: string,\n        /** Command to execute */\n        cmd: string,\n        /** Command ID */\n        cmdId: number,\n        /** Timeout of command in ms */\n        cmdTimeout?: number,\n    ): Promise<void> {\n        return this.request({\n            commandTimeout: cmdTimeout,\n            executor: (resolve, reject, timeout) => {\n                host = normalizeHostId(host);\n\n                this._socket.emit('cmdExec', host, cmdId, cmd, err => {\n                    if (timeout.elapsed) {\n                        return;\n                    }\n                    timeout.clearTimeout();\n\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve();\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Gets the system configuration.\n     *\n     * @param update Force update.\n     */\n    getSystemConfig(update?: boolean): Promise<ioBroker.SystemConfigObject> {\n        return this.request({\n            cacheKey: 'systemConfig',\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: async resolve => {\n                let systemConfig = await this.getObject('system.config');\n                (systemConfig as any) ??= {};\n                (systemConfig as any).common ??= {};\n                (systemConfig as any).native ??= {};\n\n                resolve(systemConfig!);\n            },\n        });\n    }\n\n    // returns very optimized information for adapters to minimize a connection load\n    getCompactSystemConfig(update?: boolean): Promise<ioBroker.SystemConfigObject> {\n        return this.request({\n            cacheKey: 'systemConfigCommon',\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            requireAdmin: true,\n            executor: (resolve, reject) => {\n                this._socket.emit('getCompactSystemConfig', (err, systemConfig) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        (systemConfig as any) ??= {};\n                        (systemConfig as any).common ??= {};\n                        (systemConfig as any).native ??= {};\n                        resolve(systemConfig!);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Read all states (which might not belong to this adapter) which match the given pattern.\n     *\n     * @param pattern The pattern to match.\n     */\n    getForeignStates(pattern?: string | string[] | null): ioBroker.GetStatesPromise {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getForeignStates', pattern || '*', (err, states) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(states ?? {});\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Get foreign objects by pattern, by specific type and resolve their enums.\n     *\n     * @param pattern The pattern to match.\n     * @param type The type of the object.\n     */\n    getForeignObjects<T extends ioBroker.ObjectType>(\n        pattern: string | null | undefined,\n        type: T,\n    ): Promise<Record<string, ioBroker.AnyObject & { type: T }>> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getForeignObjects', pattern || '*', type, (err, objects) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(objects as any);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Sets the system configuration.\n     *\n     * @param obj The new system configuration.\n     */\n    setSystemConfig(obj: ioBroker.SystemConfigObject): Promise<void> {\n        return this.setObject('system.config', obj);\n    }\n\n    /**\n     * Get the raw socket.io socket.\n     */\n    getRawSocket(): any {\n        return this._socket;\n    }\n\n    /**\n     * Get the history of a given state.\n     *\n     * @param id The state ID.\n     * @param options The query options.\n     */\n    getHistory(id: string, options: ioBroker.GetHistoryOptions): Promise<ioBroker.GetHistoryResult> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getHistory', id, options, (err, values) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(values!);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Get the history of a given state.\n     *\n     * @param id The state ID.\n     * @param options The query options.\n     */\n    getHistoryEx(\n        id: string,\n        options: ioBroker.GetHistoryOptions,\n    ): Promise<{\n        values: ioBroker.GetHistoryResult;\n        sessionId: number;\n        step: number;\n    }> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getHistory', id, options, (err, values, step, sessionId) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve({\n                            values: values!,\n                            sessionId: sessionId!,\n                            step: step!,\n                        });\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Get the IP addresses of the given host.\n     *\n     * @param host The host name.\n     * @param update Force update.\n     */\n    getIpAddresses(host: string, update?: boolean): Promise<string[]> {\n        host = normalizeHostId(host);\n        return this.request({\n            cacheKey: `IPs_${host}`,\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: async resolve => {\n                const obj = await this.getObject(host);\n                resolve(obj?.common.address ?? []);\n            },\n        });\n    }\n\n    /**\n     * Gets the version.\n     */\n    getVersion(update?: boolean): Promise<{ version: string; serverName: string }> {\n        return this.request({\n            cacheKey: 'version',\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getVersion', (err, version, serverName) => {\n                    // Old socket.io had no error parameter\n                    if (err && !version && typeof err === 'string' && err.match(/\\d+\\.\\d+\\.\\d+/)) {\n                        resolve({ version: err, serverName: 'socketio' });\n                    } else {\n                        if (err) {\n                            reject(err);\n                        } else {\n                            resolve({\n                                version: version!,\n                                serverName: serverName!,\n                            });\n                        }\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Gets the web server name.\n     */\n    getWebServerName(): Promise<string> {\n        return this.request({\n            cacheKey: 'webName',\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('getAdapterName', (err, name) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(name!);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Check if the file exists\n     *\n     * @param adapter adapter name\n     * @param filename file name with the full path. it could be like vis.0/*\n     */\n    fileExists(adapter: string, filename: string): Promise<boolean> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('fileExists', adapter, filename, (err, exists) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(!!exists);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Read current user\n     */\n    getCurrentUser(): Promise<string> {\n        return this.request({\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: resolve => {\n                this._socket.emit('authEnabled', (_isSecure, user) => {\n                    resolve(user);\n                });\n            },\n        });\n    }\n\n    /**\n     * Get uuid\n     */\n    getUuid(): Promise<string> {\n        return this.request({\n            cacheKey: 'uuid',\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: async resolve => {\n                const obj = await this.getObject('system.meta.uuid');\n                resolve(obj?.native?.uuid);\n            },\n        });\n    }\n\n    /**\n     * Checks if a given feature is supported.\n     *\n     * @param feature The feature to check.\n     * @param update Force update.\n     */\n    checkFeatureSupported(feature: string, update?: boolean): Promise<any> {\n        return this.request({\n            cacheKey: `supportedFeatures_${feature}`,\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('checkFeatureSupported', feature, (err, features) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        resolve(features);\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Get all adapter instances.\n     *\n     * @param update Force update.\n     */\n    /**\n     * Get all instances of the given adapter.\n     *\n     * @param adapter The name of the adapter.\n     * @param update Force update.\n     */\n    getAdapterInstances(adapter?: string | boolean, update?: boolean): Promise<ioBroker.InstanceObject[]> {\n        if (typeof adapter === 'boolean') {\n            update = adapter;\n            adapter = '';\n        }\n        adapter ||= '';\n\n        return this.request({\n            cacheKey: `instances_${adapter}`,\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: async resolve => {\n                const startKey = adapter ? `system.adapter.${adapter}.` : 'system.adapter.';\n                const endKey = `${startKey}\\u9999`;\n\n                const instances = await this.getObjectViewSystem('instance', startKey, endKey);\n                const instanceObjects = Object.values(instances);\n                if (adapter) {\n                    resolve(instanceObjects.filter(o => o.common.name === adapter));\n                } else {\n                    resolve(instanceObjects);\n                }\n            },\n        });\n    }\n\n    /**\n     * Get adapters with the given name.\n     *\n     * @param adapter The name of the adapter.\n     * @param update Force update.\n     */\n    getAdapters(adapter?: string, update?: boolean): Promise<ioBroker.AdapterObject[]> {\n        if (typeof adapter === 'boolean') {\n            update = adapter;\n            adapter = '';\n        }\n        adapter ||= '';\n\n        return this.request({\n            cacheKey: `adapter_${adapter}`,\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: async resolve => {\n                const adapters = await this.getObjectViewSystem(\n                    'adapter',\n                    `system.adapter.${adapter || ''}`,\n                    `system.adapter.${adapter || '\\u9999'}`,\n                );\n                const adapterObjects = Object.values(adapters);\n                if (adapter) {\n                    resolve(adapterObjects.filter(o => o.common.name === adapter));\n                } else {\n                    resolve(adapterObjects);\n                }\n            },\n        });\n    }\n\n    /**\n     * Get the list of all groups.\n     *\n     * @param update Force update.\n     */\n    getGroups(update?: boolean): Promise<ioBroker.GroupObject[]> {\n        return this.request({\n            cacheKey: 'groups',\n            forceUpdate: update,\n            // TODO: check if this should time out\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit(\n                    'getObjectView',\n                    'system',\n                    'group',\n                    {\n                        startkey: 'system.group.',\n                        endkey: 'system.group.\\u9999',\n                    },\n                    (err, doc) => {\n                        if (err) {\n                            reject(err);\n                        } else {\n                            resolve(getObjectViewResultToArray<ioBroker.GroupObject>(doc));\n                        }\n                    },\n                );\n            },\n        });\n    }\n\n    /**\n     * Logout current user\n     */\n    logout(): Promise<string | null> {\n        return this.request({\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('logout', err => {\n                    err ? reject(err) : resolve(null);\n                });\n            },\n        });\n    }\n\n    /**\n     * Subscribe on instance message\n     *\n     * @param targetInstance instance, like 'cameras.0'\n     * @param messageType message type like 'startCamera/cam3'\n     * @param data optional data object\n     * @param callback message handler\n     */\n    subscribeOnInstance(\n        targetInstance: string,\n        messageType: string,\n        data: any,\n        callback: InstanceMessageCallback,\n    ): Promise<{\n        error?: string;\n        accepted?: boolean;\n        heartbeat?: number;\n    } | null> {\n        return this.request({\n            commandTimeout: false,\n            executor: (resolve, reject) => {\n                this._socket.emit('clientSubscribe', targetInstance, messageType, data, (err, subscribeResult) => {\n                    if (err) {\n                        reject(err);\n                    } else if (subscribeResult) {\n                        if (subscribeResult.error) {\n                            reject(subscribeResult.error);\n                        } else {\n                            if (!targetInstance.startsWith('system.adapter.')) {\n                                targetInstance = `system.adapter.${targetInstance}`;\n                            }\n                            // save callback\n                            this._instanceSubscriptions[targetInstance] =\n                                this._instanceSubscriptions[targetInstance] || [];\n\n                            if (\n                                !this._instanceSubscriptions[targetInstance].find(\n                                    subscription =>\n                                        subscription.messageType === messageType && subscription.callback === callback,\n                                )\n                            ) {\n                                this._instanceSubscriptions[targetInstance].push({\n                                    messageType,\n                                    callback,\n                                });\n                            }\n                            resolve(subscribeResult);\n                        }\n                    }\n                });\n            },\n        });\n    }\n\n    /**\n     * Unsubscribe from instance message\n     *\n     * @param targetInstance instance, like 'cameras.0'\n     * @param messageType message type like 'startCamera/cam3'\n     * @param callback message handler\n     */\n    unsubscribeFromInstance(\n        targetInstance: string,\n        messageType: string,\n        callback: InstanceMessageCallback,\n    ): Promise<boolean> {\n        if (!targetInstance.startsWith('system.adapter.')) {\n            targetInstance = `system.adapter.${targetInstance}`;\n        }\n\n        let deleted;\n        const promiseResults = [];\n        do {\n            deleted = false;\n            const index = this._instanceSubscriptions[targetInstance]?.findIndex(\n                sub => (!messageType || sub.messageType === messageType) && (!callback || sub.callback === callback),\n            );\n\n            if (index !== undefined && index !== null && index !== -1) {\n                deleted = true;\n                // remember messageType\n                const _messageType = this._instanceSubscriptions[targetInstance][index].messageType;\n\n                this._instanceSubscriptions[targetInstance].splice(index, 1);\n                if (!this._instanceSubscriptions[targetInstance].length) {\n                    delete this._instanceSubscriptions[targetInstance];\n                }\n\n                // try to find another subscription for this instance and messageType\n                const found =\n                    this._instanceSubscriptions[targetInstance] &&\n                    this._instanceSubscriptions[targetInstance].find(sub => sub.messageType === _messageType);\n\n                if (!found) {\n                    promiseResults.push(\n                        this.request({\n                            commandTimeout: false,\n                            executor: (resolve, reject) => {\n                                this._socket.emit(\n                                    'clientUnsubscribe',\n                                    targetInstance,\n                                    messageType,\n                                    (err, wasSubscribed) => (err ? reject(err) : resolve(wasSubscribed)),\n                                );\n                            },\n                        }),\n                    );\n                }\n            }\n        } while (deleted && (!callback || !messageType));\n\n        if (promiseResults.length) {\n            return Promise.all(promiseResults).then(results => !!results.find(result => result));\n        }\n\n        return Promise.resolve(false);\n    }\n\n    /**\n     * Send log to ioBroker log\n     *\n     * @param text Log text\n     * @param level `info`, `debug`, `warn`, `error` or `silly`\n     */\n    log(text: string, level?: string): Promise<null> {\n        return text\n            ? this.request({\n                  commandTimeout: false,\n                  executor: resolve => {\n                      this._socket.emit('log', text, level);\n                      return resolve(null);\n                  },\n              })\n            : Promise.resolve(null);\n    }\n\n    /**\n     * This is a special method for vis.\n     * It is used to not send to server the changes about \"nothing_selected\" state\n     *\n     * @param id The state that has to be ignored by communication\n     */\n    setStateToIgnore(id: string): void {\n        this.ignoreState = id;\n    }\n}\n"]}